%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% chapters/chapter5.tex
%
% Copyright 2012, Jeffrey Hellrung.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Nearly Incompressible Linear Elasticity} \label{ch:pt2.LE}

\section{Background and Existing methods} \label{sec:ch5.background}

\footnote{The content of this chapter is largely a revision of a recently submitted publication entitled ``A second-order virtual node
algorithm for nearly incompressible linear elasticity in irregular domains'' by Y. Zhu, Y. Wang, J. Hellrung, A. Cantarero, E. Sifakis, J. Teran.}
To review, this chapter addresses the solution of the equilibrium equations of linear elasticity, repeated here for convenience:
\begin{subequations} \label{eq:ch5.LE}
\begin{align}
-\lrp{\Delta \bfI + (\lambda + \mu) \nabla \nabla^t} \bfu & = \bff \quad \in \Omega \label{eq:ch5.LE.PDE} \\
\bfu & = \bfu_0 \quad \in \dOmega_d \label{eq:ch5.LE.D} \\
\mu \lrp{\bfu \cdot \hatn + \nabla \lrp{\bfu \cdot \hatn}} + \lambda \lrp{\nabla \cdot \bfu} \hatn & = \bfg \quad \in \dOmega_n \label{eq:ch5.LE.N}.
\end{align}
\end{subequations}
where we wish to solve for the unknown displacement map $\bfu$.

Following the early methods of Hyman \cite{Hyman52} and Saul'ev \cite{Saul'ev63}, the fictitious domain approach has been used with incompressible materials in a number of works \cite{Bertrand97, Glowinski94b, Glowinski99, Glowinski01, Biros04, Parussini08, Rutka08, Parussini09, Teran09}. These approaches embed the irregular geometry in a more simplistic domain for which fast solvers exist (e.g., fast Fourier transforms). The calculations include fictitious material in the complement of the domain of interest. A forcing term (often from a Lagrange multiplier) is used to maintain boundary conditions at the irregular geometry. Although these techniques naturally allow for efficient solution procedures, they depend on a smooth solution across the embedded domain geometry for optimal accuracy, which is not typically possible.

The \emph{eXtended Finite Element Method} (XFEM) and related approaches in the finite element literature also make use of geometry embedded in regular elements. Although originally developed for crack-based field discontinuities in elasticity problems, these techniques are also used with embedded problems in irregular domains. Daux et al. first showed that these techniques can naturally capture embedded Neumann boundary conditions \cite{Daux00, Sukumar01}. These approaches are equivalent to the variational cut cell method of Almgren et al. in \cite{Almgren97}. Enforcement of Dirichlet constraints is more difficult with variational cut cell approaches \cite{Moes06, Lew.Adrian08} and typically involves a Lagrange multiplier or stabilization. Dolbow and Devan recently investigated the convergence of such approaches with incompressible materials and point out that much analysis in this context remains to be completed \cite{Dolbow04}. Despite the lack of thorough analysis, such XFEM approaches appear to be very accurate and have been used in many applications involving incompressible materials in irregular domains \cite{Wagner01, Chessa03, Coppola05, Gerstenberger08, Becker09}.

There are also many \emph{Finite Difference Methods} (FDM) and \emph{Finite Volume Methods} (FVM) that utilize cut uniform grid cells. Many of these methods have been developed in the context of incompressible flow. For example, Almgren et al. use cut uniform bilinear cells to solve the Poisson equation for pressures in incompressible flow calculations \cite{Almgren97}. Marelle et al. use collocated grids and define define sub cell interface and boundary geometry in cut cells via level sets \cite{Marella05}. Ng et al. also use level set descriptions of the irregular domain and achieve second order accuracy in $L^{\infty}$ for incompressible flows \cite{Ng.YenTiang09}. The approach of Batty et al. is similar, but not as accurate \cite{Batty07}. Although not technically a cut cell approach, the immersed interface method has been used to improve accuracy for incompressible flow calculations in irregular domains \cite{Weigmann00, Rutka04, Li.Zhilin06b, Chen08, Rutka08, Xu.Sheng08}. Cut cell FDM and FVM have also been developed for incompressible and nearly incompressible elastic materials. Bijelonja et al. use cut cell FVM to enforce incompressibility more accurately than is typically seen with FEM \cite{Bijelonja06}. Beir\~{a}o da Veiga et al. use polygonal FVM cells to avoid remeshing with irregular domains \cite{BeiraodaVeiga09}. Barton et al. \cite{Barton10} and Hill et al. \cite{Hill10} use cut cells with Eulerian elastic/plastic flows.

Many approaches have been proposed to solve elasticity equations in a scalable way at high resoultions. For this class of problems, iterative methods are usually employed rather than direct methods due to memory considerations. For iterative methods to be scalable, we mean that the method requires only a constant (and small) number of iterations, independent of the grid resolution, to obtain a solution. While many methods of this type have proven quite effective, accommodating mixed boundary conditions on an embedded interface is highly nontrivial, especially when efficiency of implementation is a priority. Most methods have also been created specifically to work with either purely Dirichlet or purely traction boundary conditions, but have not been demonstrated to be effective in both cases. Constructing preconditioners for solving the KKT systems that result from discretizing the equations in a mixed formulation have been studied by Klawonn \cite{Klawonn95, Klawonn98.1} and Bramble and Pasciak \cite{Bramble88}. Work has also been done on using domain decomposition methods with PCG \cite{Farhat00} and GMRES \cite{Klawonn98.2} to solve Stokes and elasticity problems. \emph{Balancing Domain Decomposition by Constraints} (BDDC) has also been used to build preconditioners for solving these problems \cite{Dohrmann03, Pavarino10}. Many authors have also looked at applying multigrid methods to problems in solid mechanics \cite{Verfurth84, Kocvara87, Haung90, Brenner93, Cai.Zhiqiang98, Axelsson99, Hiptmair99, Schoberl99, Wieners00, Heys04, Gaspar08, Lee.Young-Ju09, Zhu.Yongning10}, including handling issues arising from nearly incompressible materials. Mixed FEM formulations are one example that maintain good multigrid convergence properties for nearly incompressible materials demonstrated on the Dirichlet boundary case \cite{Brenner93, Schoberl99, Lee.Young-Ju09}. FOSLS methods have been demonstrated to produce systems that can be effectively solved using algebraic multigrid methods by rewriting the elasticity equations as a first order system using least squares \cite{Cai.Zhiqiang98, Heys04}. Multigrid applied to FEM discretized equations using a smoother based on a Schur complement has been studied by different authors \cite{Axelsson99, Wieners00}. While demonstrating the ability to solve large problems, the Schur complement approach requires the action of the inverse of the displacements matrix in the smoothing process which is a more expensive smoothing operation than that offered by other methods. Distributive smoothers offer a different option for the smoothing process that has proved effective on elasticity equations discretized with FEM \cite{Hiptmair99} and on staggered grids \cite{Gaspar08}. In our approach, we will look at using distributive smoothing similar to those described in Gaspar et al. \cite{Gaspar08}.

\section{Mixed Finite Element Formulation} \label{sec:ch5.mixedfem}

In order to accurately handle linear elastic materials near the incompressible limit, we use an augmented form of the equilibrium equations. By introducing a pressure variable as an unknown, we can achieve a stable numerical discretization independent of the degree of incompressibility. We will use the weak form of this augmented system to derive a mixed finite element formulation \cite{Brezzi91}. The augmented form of our equations arises by introducing $p := -(\lambda/\mu) \nabla \cdot \bfu$. With this definition, $\bssigma(\bfu) = \mu (\nabla \bfu + (\nabla \bfu)^t) - \mu p \bfI$ and the derived equations
\begin{subequations} \label{eq:ch5.augmented.strong}
\begin{align}
-\mu (\Delta \bfI + \nabla \nabla^t) \bfu + \mu \nabla p & = \bff \quad \in \Omega; \label{eq:ch5.augmented.strong.PDE} \\
-\mu \nabla \cdot \bfu - \frac{\mu^2}{\lambda} p & = 0 \quad \in \Omega; \\
\bfu & = \bfu_0 \quad \in \dOmega_d; \\
\mu (\bfu \cdot \hatn + \nabla (\bfu \cdot \hatn)) - \mu p \hatn & = \bfg; \quad \in \dOmega_n
\end{align}
\end{subequations}
are then equivalent to the original equations \eqref{eq:ch5.LE}.

We use this augmented form of the equations to derive an equivalent variational form of the equilibrium equations of linear elasticity. A weak form can be derived by taking the inner product of the strong form with an arbitrary vector-valued function $\bfv \in \bfV_0 := (H_{0,\dOmega_d}^1(\Omega))^d$ and by enforcing $p = -(\lambda/\mu) \nabla \cdot \bfu$ weakly:
\begin{center}
Find $(\bfu,p) \in (H^1(\Omega))^d \times L^2(\Omega)$, $\bfu \rvert_{\dOmega_d} = \bfu_0$, such that
\end{center}
\begin{subequations} \label{eq:ch5.augmented.weak}
\begin{align}
& \int_{\Omega} 2 \mu \lrp{\frac{\nabla \bfu + (\nabla \bfu)^t}{2}} : \lrp{\frac{\nabla \bfv + (\nabla \bfv)^t}{2}} - \mu p (\nabla \cdot \bfv) d\bfx \\
& \qquad = -\int_{\Omega} \bff \cdot \bfv d\bfx + \int_{\dOmega_n} \bfg \cdot \bfv d\bfS(\bfx) \quad \forall \bfv \in (H^1_{0,\dOmega_d}(\Omega))^d, \\
& \int_{\Omega} \lrp{-\mu q \nabla \cdot \bfu - \frac{\mu^2}{\lambda} p q} d\bfx = 0 \quad \forall q \in L^2(\Omega).
\end{align}
\end{subequations}

\subsection{Discretization} \label{subsec:ch5.discretization}

We discretize this variational formulation using a mixed finite element method defined on a MAC-type staggered grid. Han et al. demonstrated the stability and optimal convergence of this formulation applied to the Stokes equations on a square domain \cite{Han.Houde98}. We generalize this approach to the case of nearly incompressible linear elasticity in embedded domains. We approximate the Sobolev space $\bfV := (H^1(\Omega))^d$ with a finite element subspace $\bfV^h$, where each displacement component of a function in $\bfV^h$ is represented as a piecewise bilinear scalar function defined on a staggered quadrilateral grid (see Figure~\ref{fig:ch5.embedding}). To be more specific, consider the staggered grids
\begin{align*}
\calG^x_h & := \set{ (ih, (j-1/2)h) : (i,j) \in \calI_x \subset \bbZ^2 }, \\
\calG^y_h & := \set{ ((i-1/2)h, jh) : (i,j) \in \calI_y \subset \bbZ^2 }.
\end{align*}
Here, $h$ is the discrete spacing between grid points. Furthermore, we use the following notation to denote quadrilaterals defined by these grids:
\begin{align*}
T^x_{ij} & := \set{ (x,y) : ih < x < (i+1)h, \; (j-1/2)h < y < (j+1/2)h }, \\
T^y_{ij} & := \set{ (x,y) : (i-1/2)h < x < (i+1/2)h, \; jh < y < (j+1)h }.
\end{align*}
The sets $\calI_x$ and $\calI_y$ used in the definition of grids $\calG^x_h$ and $\calG^y_h$ are defined as the collection of vertices incident on some quadrilateral $T^x_{ij}$ or $T^y_{ij}$, respectively, whose intersection with the domain $\Omega$ is non-empty. In other words, $\calI_x$ and $\calI_y$ are the sets of vertices in the staggered lattices that are at most an $L^{\infty}$-distance of $h$ away from $\Omega$. Henceforth, we will use
\begin{align*}
\calT^x_h & := \set{ T^x_{ij} : T^x_{ij} \cap \Omega \neq \emptyset }, \\
\calT^y_h & := \set{ T^y_{ij} : T^y_{ij} \cap \Omega \neq \emptyset }
\end{align*}
to denote the collection of $x$ and $y$ grid quadrilaterals that intersect (or embed) the domain $\Omega$.

\setlength{\figurewidth}{0.32\columnwidth}
\begin{figure}[htbp]
\begin{center}
\subfigure[$\calT^p_h$]
{\includegraphics[width=\figurewidth]{part2/chapter5/figures/bw/grid_p8}}
\subfigure[$\calT^x_h$]
{\includegraphics[width=\figurewidth]{part2/chapter5/figures/bw/grid_x8}}
\subfigure[$\calT^y_h$]
{\includegraphics[width=\figurewidth]{part2/chapter5/figures/bw/grid_y8}}
\caption{Staggered grid finite element quadrangulation and embedded domain boundary.}
\label{fig:ch5.embedding}
\end{center}
\end{figure}

We construct two subspaces of $H^1(\Omega)$ based on these respective quadrangulations:
\begin{align*}
V_x^h & := \set{ v_h \in C^0(\Omega) : v_h \rvert_{T^x_{ij}} \in Q_1(T^x_{ij}) \; \forall \, T^x_{ij} \in \calT^x_h }, \\
V_y^h & := \set{ v_h \in C^0(\Omega) : v_h \rvert_{T^y_{ij}} \in Q_1(T^y_{ij}) \; \forall \, T^y_{ij} \in \calT^y_h },
\end{align*}
where $Q_1(T^k_{ij})$ is the space of bilinear functions on the quadrilateral $T^k_{ij}$. For simplicity of notation in subsequent equations we will also use the mappings
\begin{align*}
& \eta_1 \colon I_1 := \{ 1, 2, \dotsc, N_x \} \to \calI_x, \\
& \eta_2 \colon I_2 := \{1, 2, \dotsc, N_y \} \to \calI_y
\end{align*}
to associate each $x$ and $y$ grid vertex with a unique integer between $1$ and
$N_x := \abs{\calI_x}$ and $1$ and $N_y := \abs{\calI_y}$, respectively. With this convention, any approximate solution $\bfu^h \in V_x^h \times V_y^h$ can be expressed as
\begin{equation} \label{eq:ch5.staggeredapproximation.u}
\bfu^h(\bfx) :=
\begin{pmatrix}
\displaystyle \sum_{k_1 \in I_1} u^1_{k_1} N^1_{k_1}(\bfx) \\
\displaystyle \sum_{k_2 \in I_2} u^2_{k_2} N^2_{k_2}(\bfx)
\end{pmatrix},
\end{equation}
where $N^1_{k_1}$ and $N^2_{k_2}$ are the commonly used piecewise bilinear interpolating basis functions associated with nodes $k_1$ and $k_2$, respectively, in $\calT^x_h$ and $\calT^y_h$. Our discrete equations for the approximate solution $\bfu^h$ can thus be seen to be over $N_x + N_y$ scalar unknowns.

We additionally approximate the pressure space $V_p := L^2(\Omega)$ with a piecewise constant finite element space $V_p^h$ defined on a quadrangulation $\calT^p_h$ over the primary grid (or, henceforth, the pressure grid) $\calG^p_h$:
\begin{align*}
\calG^p_h & := \set{ ((i + 1/2)h, (j + 1/2)h) : (i,j) \in \calI_p \subset \bbZ^2 }, \\
T^p_{ij} & := \set{ (x,y) : ih < x < (i+1)h, \; jh < y < (j+1)h }, \\
\calT^p_h & := \set{ T^p_{ij} : T^p_{ij} \cap \Omega \neq \emptyset }, \\
V_p^h & := \set{ p^h \in L^2(\Omega) : p_h \rvert_{T^p_{ij}} \in P_0(T^p_{ij}) \; \forall \, T^p_{ij} \in \calT^p_h },
\end{align*}
where $P_0(T^p_{ij})$ is the space of constant functions on the quadrilateral $T^p_{ij}$. The grid $\calG^p_h$ is a cell-centered grid (as opposed to a node-centered grid, such as $\calG^x_h$ or $\calG^y_h$); there is one pressure degree of freedom associated with the center of each pressure cell $T^p_{ij}\in \calT^p_h$. The set $\calI_p$ is defined similarly to $\calI_x$ and  $\calI_y$, however here it refers to the collection of cell-centered indices in the grid $\calG^p_h$ whose associated quadrilaterals $T^p_{ij}$ have a non-empty intersection with $\Omega$. For the sake of simplicity in subsequent equations, we again use a mapping
\begin{equation*}
\eta_3 \colon I_3 := \{ 1, 2, \dotsc, N_p \} \to \calI_p
\end{equation*}
to associate each cell in the pressure grid with a unique integer between 1 and $N_p := \abs{\calI_p}$. Thus, any approximate pressure solution $p^h$ has the representation
\begin{equation} \label{eq:ch5.staggeredapproximation.p}
p^h(\bfx) := \sum_{k_3 \in I_3} p_{k_3} \chi_{T^p_{k_3}}(\bfx)
\end{equation}
where (with some abuse of notation) $\chi_{T^p_k}(\bfx)$ is the characteristic function associated with the quadrilateral $T^p_k$. That is,
\begin{equation*}
\chi_{T^p_k}(\bfx) := \begin{cases} 1, & \bfx \in T^p_k \\ 0, & \bfx \notin T^p_k \end{cases}.
\end{equation*}

We choose test functions $\bfv^h(\bfx) = N^m_{k_m}(\bfx) \bfe_m$ ($m \in \set{1,2}$, $k_m \in I_m$) and substitute the finite element discretization \eqref{eq:ch5.staggeredapproximation.u}, \eqref{eq:ch5.staggeredapproximation.p} into each term in the mixed variational form \eqref{eq:ch5.augmented.weak}:
\begin{subequations} \label{eq:ch5.integrations}
\begin{align}
& 2 \mu \int_{\Omega} \lrp{\frac{\nabla \bfu^h + (\nabla \bfu^h)^t}{2}} : \lrp{\frac{\nabla \bfv^h + (\nabla \bfv^h)^t}{2}} d\bfx \\
& \qquad = \mu \int_{\Omega} \lrp{\nabla \bfu^h + (\nabla \bfu^h)^t} : \nabla \bfv^h d\bfx = \mu \sum_{i,j \in \set{1,2}} \int_{\Omega} (u^h_{i,j} + u^h_{j,i}) v^h_{j,i} d\bfx \\
& \qquad = \mu \sum_{i,j \in \set{1,2}} \int_{\Omega} (u^h_{i,j} + u^h_{j,i}) N^m_{k_m,i} \delta_{mj} d\bfx = \mu \sum_{i \in \set{1,2}} \int_{\Omega} (u_{i,m}+u_{m,i}) N^m_{k_m,i} d\bfx \\
& \qquad = \mu \sum_{i \in \set{1,2}} \int_{\Omega} \lrp{\sum_{k_i \in I_i} u^i_{k_i} N^i_{k_i,m} + \sum_{k_m \in I_m} u^m_{k_m} N^m_{k_m,i}} N^m_{k_m,i} d\bfx \\
& \qquad = \mu \sum_{i \in \set{1,2}} \sum_{k_i \in I_i} u^i_{k_i} \int_{\Omega} N^i_{k_i,m} N^m_{k_m,i} d\bfx + \mu \sum_{k_m \in I_m} u^m_{k_m} \sum_{i \in \set{1,2}} \int_{\Omega} \lrp{N^m_{k_m,i}}^2 d\bfx; \\
& -\mu \int_{\Omega} p \nabla \cdot \bfv^h d\bfx = -\mu \sum_{k_3 \in I_3} p_{k_3} \int_{T^p_{k_3} \cap \Omega} N^m_{k_m,m} d\bfx; \\
& \int_{\Omega} \bff \cdot \bfv^h d\bfx = \int_{\Omega} f_m N^m_{k_m} d\bfx; \\
& \int_{\dOmega_n} \bfg \cdot \bfv^h d\bfS(\bfx) = \int_{\dOmega_n} g_m N^m_{k_m} d\bfS(\bfx).
\end{align}
\end{subequations}
We can also choose $\bfv^h \equiv \bfzero$ and $q^h(\bfx) = \chi_{T^p_{k_3}}(\bfx)$ ($k_3 \in I_3$) to give the corresponding pressure equations:
\begin{equation*}
-\mu \sum_{i \in \set{1,2}} \sum_{k_i \in I_i} u^i_{k_i} \int_{T^p_{k_3} \cap \Omega} N^i_{k_i,i} d\bfx - \frac{\mu^2}{\lambda} p_{k_3} \int_{T^p_{k_3} \cap \Omega} d\bfx = 0.
\end{equation*}

Since the variational form is derived from an energy minimization problem, the discretized linear system can trivially be seen to be symmetric. Specifically, if $\vec{u} \in \bbR^{N_x + N_y}$ is our vector of displacement unknowns (where, say, the $x$ degrees of freedom are ordered first followed by the $y$ degrees of freedom second) and $\vec{p} \in \bbR^{N_p}$ our vector of pressure unknowns, then our system over the vector $\tilde{u}$ of $N := N_x + N_y + N_p$ degrees of freedom is of the form:
\begin{equation} \label{eq:ch5.LEsystem.augmented.discrete}
\begin{pmatrix} A_u & G^t \\ G & D_p \end{pmatrix}
\begin{pmatrix} \vec{u} \\ \vec{p} \end{pmatrix}
= \begin{pmatrix} \vec{f} \\ \vec{0} \end{pmatrix}
\quad \text{or} \quad \tilde{A} \tilde{u} = \tilde{f}
\end{equation}
where $\tilde{u} = (\vec{u} \; \vec{p})$ and $\tilde{f} = (\vec{f} \; \vec{0})$. Furthermore, our use of regular grids gives the discrete equations a finite difference interpretation. If we scale the system by $1/h^2$, each block in the discrete system approximates the corresponding differential operator in \eqref{eq:ch5.augmented.strong}, i.e., \eqref{eq:ch5.LEsystem.augmented.discrete} discretizes the following equation:
\begin{equation} \label{eq:ch5.LEsystem.augmented.continuous}
h^2 \begin{pmatrix} -\mu (\Delta + \nabla \nabla^t) & \mu \nabla \\ -\mu \nabla^t & -\mu^2/\lambda \end{pmatrix}
\begin{pmatrix} \bfu \\ p \end{pmatrix}
= \begin{pmatrix} h^2 \bff \\ 0 \end{pmatrix}.
\end{equation}
The linear system is the Hessian matrix of a saddle point problem, therefore the discretized system is symmetric but indefinite. Indeed, the upper-left block $A_u$ is positive definite whie the lower-right block $D_p$ is negative definite.

\subsection{Implementation Details} \label{subsec:ch5.implementation}

For ease of implementation, we perform the integrations involved in the discrete equations \eqref{eq:ch5.integrations} in an element-by-element fashion. Each area integral is represented as a sum of integrals over spatially disjoint elements whose union is the embedded domain. Specifically, we individually address the integration over the intersection of each quadrilateral of the pressure grid with the domain $T^p_{k_3} \cap \Omega$:
\begin{align*}
\int_{\Omega} \lrp{N^m_{k_m,i}}^2 d\bfx & = \sum_{k_3 \in I_3} \int_{T^p_{k_3} \cap \Omega} \lrp{N^m_{k_m,i}}^2 d\bfx; \\
\int_{\Omega} N^i_{k_i,m} N^m_{k_m,i} d\bfx & = \sum_{k_3 \in I_3} \int_{T^p_{k_3} \cap \Omega} N^i_{k_i,m} N^m_{k_m,i} d\bfx; \\
\int_{\Omega} N^m_{k_m} d\bfx & = \sum_{k_3 \in I_3} \int_{T^p_{k_3} \cap \Omega} N^m_{k_m} d\bfx \\
\int_{\dOmega_n} N^m_{k_m} d\bfS(\bfx) & = \sum_{k_3 \in I_3} \int_{T^p_{k_3} \cap \dOmega_n} N^m_{k_m} d\bfS(\bfx).
\end{align*}
In the interior, this simply amounts to evaluating the same integrals over each uncut quadrilateral $T^p_{k_3}$. However, at the boundary, care must be taken to respect the material region when the intersection between a pressure cell and the domain is non-trivial. In both the boundary and interior cases there will be $13$ degrees of freedom involved in the integration over such a pressure cell. This is because the staggering of various grids leads to $13$ interpolating basis functions supported over a given pressure cell: $6$ $x$-basis functions, $6$ $y$-basis functions, and $1$ pressure basis function. In other words, we express the stiffness matrix $A_u$ of our discrete linear system as a sum of $13 \times 13$ element stiffness matrices $A_u^{k_3}$. We further break the integrals involved in a given pressure cell $T^p_{k_3}$ up into four subintegrals over the sub-cell quadrants $\set{\omega_1, \omega_2, \omega_3, \omega_4}$ of $T^p_{k_p}$ (see Figure~\ref{fig:ch5:stiffnessmatrix.element}). This is because the integrands are smooth over each quadrant; indeed, the integrands are quadratic, and we simply perform these integrations analytically. This observation effectively decomposes the element stiffness matrix $A_u^{k_3}$ over the sub-cell quadrants $\set{\omega_i}$ into the sub-element stiffness matrices $\set{(A_u^{k_3})_{\omega_i}}$. For example, referring to Figure~\ref{fig:ch5:stiffnessmatrix.element}(c), $(A_u^{k_3})_{\omega_1}$ involves $X_1$, $X_2$, $X_3$, $X_4$, $Y_7$, $Y_8$, $Y_{10}$, $Y_{11}$, and $P_{13}$ so it only has nonzero values on rows and columns involving these $9$ degrees of freedom. The resulting equations based on those degrees of freedom are
\begin{equation*}
(A_u^{k_3})_{\omega_1} =
\mu \left( \begin{array}{c@{}|*{3}{|c@{}}}
{}_i\diagdown^j &
\begin{array}{*{4}{c}} X_1 & X_2 & X_3 & X_4 \end{array} &
\begin{array}{*{4}{c}} Y_7 & Y_8 & Y_{10} & Y_{11} \end{array} &
P_{13} \\
\hline\hline
\begin{array}{c} X_1 \\ X_2 \\ X_3 \\ X_4 \end{array} &
\int_{\omega_1} \!\!\! \nabla N^1_i \cdot \nabla N^1_j + N^1_{i,1} N^1_{j,1} &
\int_{\omega_1} \!\! N^1_{i,2} N^2_{j,1} &
-\int_{\omega_1} \!\! N^1_{i,1} \\
\hline
\begin{array}{c} Y_7 \\ Y_8 \\ Y_{10} \\ Y_{11} \end{array} &
\int_{\omega_1} \!\! N^2_{i,1} N^1_{j,2} &
\int_{\omega_1} \!\!\! \nabla N^2_i \cdot \nabla N^2_j + N^2_{i,2} N^2_{j,2} &
-\int_{\omega_1} \!\! N^2_{i,2} \\
\hline
P_{13} &
-\int_{\omega_1} \!\! N^1_{j,1} &
-\int_{\omega_1} \!\! N^2_{j,2} &
-\frac{\mu}{\lambda} \int_{\omega_1} \!\! 1
\end{array} \right)
\end{equation*}
If we order the $13$ nodes with indices shown in Figure~\ref{fig:ch5:stiffnessmatrix.element}(a), then on the interior of the domain, where $T^p_{k_3} \subset \Omega$, the sum of these four subintegrals is always the same:
\begin{equation} \label{eq:ch5.stiffnessmatrix.interior}
A_u^{k_3} =
\mu
\begin{pmatrix}
{\displaystyle \frac{1}{64}}
\lrp{\footnotesize \begin{array}{*{6}{r@{\,}}|*{6}{@{\,}r}}
+16&  0&  0&-16&  0&  0& +9& -6& -3& +3& -2& -1\\
  0&+16&-16&  0&  0&  0& +3& +6& -9& +1& +2& -3\\
  0&-16&+96&-64&  0&-16& -6& +4& +2& +6& -4& -2\\
-16&  0&-64&+96&-16&  0& -2& -4& +6& +2& +4& -6\\
  0&  0&  0&-16&+16&  0& -3& +2& +1& -9& +6& +3\\
  0&  0&-16&  0&  0&+16& -1& -2& +3& -3& -6& +9\\\hline
 +9& +3& -6& -2& -3& -1&+16&  0&  0&  0&-16&  0\\
 -6& +6& +4& -4& +2& -2&  0&+96&  0&-16&-64&-16\\
 -3& -9& +2& +6& +1& +3&  0&  0&+16&  0&-16&  0\\
 +3& +1& +6& +2& -9& -3&  0&-16&  0&+16&  0&  0\\
 -2& +2& -4& +4& +6& -6&-16&-64&-16&  0&+96&  0\\
 -1& -3& -2& -6& +3& +9&  0&-16&  0&  0&  0&+16
\end{array}} &
-{\displaystyle \frac{h}{8}}
\lrp{\begin{array}{c}
-1\\+1\\-6\\+6\\-1\\+1\\\hline-1\\-6\\-1\\+1\\+6\\+1
\end{array}} \\
-{\displaystyle \frac{h}{8}}
\lrp{\begin{array}{*{6}{r@{\;}}|*{6}{@{\;}r}}
-1&+1&-6&+6&-1&+1&-1&-6&-1&+1&+6&+1
\end{array}} &
-h^2 \mu / \lambda
\end{pmatrix}.
\end{equation}

\setlength{\figurewidth}{0.30\columnwidth}
\begin{figure}[htbp]
\begin{center}
\subfigure[]
{\includegraphics[trim=22cm 28cm 6cm 1cm,clip,width=\figurewidth]{part2/chapter5/figures/bw/grid_esm2.png}}
\subfigure[]
{\includegraphics[trim=22cm 28cm 6cm 1cm,clip,width=\figurewidth]{part2/chapter5/figures/bw/grid_esm1.png}}
\subfigure[]
{\includegraphics[trim=22cm 28cm 6cm 1cm,clip,width=\figurewidth]{part2/chapter5/figures/bw/grid_esm3.png}}
\caption{(a) A interior pressure cell and the $13$ degrees of freedom involved in the corresponding element stiffness matrix. (b) A typical boundary pressure cell. (c) The degrees of freedom involved in the sub-elemental stiffness matrix corresponding to quadrant $\omega_1$. }
\label{fig:ch5:stiffnessmatrix.element}
\end{center}
\end{figure}

The global stiffness matrix $A_u$ generated from the sum of all the element stiffness matrices $\set{A_u^{k_3}}$ at an interior degree of freedom ($x$, $y$, or $p$) has a stencil shown in Figure~\ref{fig:ch5.stiffnessmatrix.global}.

\setlength{\figurewidth}{0.80\columnwidth}
\begin{figure}[htbp]
\begin{center}
\includegraphics[width=\figurewidth]{part2/chapter5/figures/bw/A_stencil_latex.png}
\caption{Global stiffness matrix stencils centered at an interior $x$ degree of freedom (left), $y$ degree of freedom (middle), and $p$ degree of freedom (right).}
\label{fig:ch5.stiffnessmatrix.global}
\end{center}
\end{figure}

For boundary cells where $T^p_{k_3} \not\subset \Omega$, we must perform the integrations involved in each of the entries of $(A_u^{k_3})_{\omega_i}$ more carefully, taking into account the boundary geometry. The technique is similar to that presented in Chapter~\ref{ch:pt2.poisson}, specifically \S\ref{subsec:ch4.discretization.embedding}, and will be discussed in more detail in the following subsection. The process of constructing the global stiffness matrix $A_u$ from each of the $13 \times 13$ element stiffness matrices $A_u^{k_3}$ is explained in Algorithm~\ref{alg:ch5.stiffnessmatrix.construction}.

\begin{algorithm}[htbp]
\caption{Construction of global stiffness matrix $A_u$ from the element stiffness matrices $A_u^{k_3}$}
\label{alg:ch5.stiffnessmatrix.construction}
\begin{algorithmic}[1]
\STATE $A_u \leftarrow 0$
\FOR{$k_3 = 1, \dotsc, N_p$}
    \IF{$T^p_{k_3} \subset \Omega$}
        \STATE Use $A_u^{k_3}$ from \eqref{eq:ch5.stiffnessmatrix.interior}.
    \ELSE
        \STATE Evaluate integrations over each quadrant $\omega_i$ to compute $(A_u^{k_3})_{\omega_i}$
        \STATE $A_u^{k_3} = \sum_i (A_u^{k_3})_{\omega_i}$
    \ENDIF
    \FOR{$i' = 1, \dotsc, 13$}
        \STATE $i := \operatorname{mesh}(k_3,i')$ \COMMENT{$i$ is the global index corresponding to the local element index $i'$}
        \FOR{$j' = 1, \dotsc, 13$}
            \STATE $j := \operatorname{mesh}(k_3,j')$
            \STATE $(A_u)_{ij} \plusequal (A_u)^{k_3}_{i'j'}$
        \ENDFOR
    \ENDFOR
\ENDFOR
\end{algorithmic}
\end{algorithm}

\subsection{Discrete Geometric Representation and Integration} \label{subsec:ch5.discretization.geometry}

We discretize the domain $\Omega$ by embedding it in a regular Cartesian grid. Specifically, we use a level set function defined over a subgrid doubly refined with respect to $\calG^x_h, \calG^y_h, \calG^p_h$:
\begin{equation*}
\calG^{\phi} = \set{(ih/2, jh/2)}.
\end{equation*}
This doubly refined subgrid is thus a superset of the grids $\calG^x_h, \calG^y_h, \calG^p_h$. The level set function values at the vertices of the doubly refined subgrid $\calG^{\phi}$ are used to determine the points of intersection between the zero isocontour and the coordinate axes-aligned edges of $\calG^{\phi}$. The boundary of $\Omega$ is then approximated by a segmented curve $\dOmega^h$ connecting these intersection points. The geometric domain is approximated within the region enclosed by $\dOmega^h$ (see Figure~\ref{fig:ch5.boundary}). Near the boundary, the domain within each subgrid cell is approximated by a polygon determined from the boundary edges of the subgrid cell and by straight lines that connect boundary intersection points as demonstrated in Figure~\ref{fig:ch5.boundary}. Thus we can think of our discrete domain as a union of doubly refined uncut quadrilaterals on the interior and polygonal regions contained within doubly refined cut quadrilaterals on the boundary.

\setlength{\figurewidth}{0.40\columnwidth}
\begin{figure}[htbp]
\begin{center}
\subfigure[]
{\includegraphics[trim=160mm 162mm 0mm 0mm,clip,width=\figurewidth]{part2/chapter5/figures/bw/grid_zoomin8.png}}
\subfigure[]
{\includegraphics[trim=160mm 162mm 0mm 0mm,clip,width=\figurewidth]{part2/chapter5/figures/bw/grid_bdrycurve8.png}}
\caption{A zoomed-in view of Figure~\ref{fig:ch5.embedding}(a). We sample a the level set function implicitly defining $\Omega$ on the doubly refined subgrid depicted in (a), and use this to generate a segmend curve approximation $\dOmega_h$ to $\dOmega$, as in (b).}
\label{fig:ch5.boundary}
\end{center}
\end{figure}

This partitioning of the domain into doubly refined quadrilaterals naturally supports our integration conventions needed for the sub-element stiffness matrices $(A_u^{k_3})_{\omega_i}$ discussed in the previous section. The integrals needed for these matrices are trivially precomputed analytically when $\omega_i$ is uncut. On the other hand, when $\omega_i$ \emph{is} cut by the boundary, we can still perform the integrations analytically in the same fashion as in \cite{Bedrossian10} and analogous to \S\ref{subsec:ch4.discretization.embedding}. To summarize, the integrands of the requisite integrals necessary to compute the entries of $(A_u^{k_3})_{\omega_i}$ are (at most) degree $2$ polynomials, hence one may easily apply the divergence theorem to explicitly transform the area integrals over $\omega_i \cap \Omega$ into line integrals over $\partial(\omega_i \cap \Omega)$. One may then analytically evaluate these latter integrals via an explicit parameterization of the individual line segments; or via an appropriate $1$-dimensional Gaussian quadrature rule (which is, of course, more similar to the approach taken in \S\ref{subsec:ch4.discretization.embedding}). As with the discretization described in Chapter~\ref{ch:pt2.poisson}, this careful treatment of the integrals near the boundary is key to obtaining second order accuracy in $L^\infty$.

\section{Dirichlet Boundary Conditions} \label{sec:ch5.dirichlet}

We have thus far assumed that our solution satisfies the Dirichlet boundary conditions \eqref{eq:ch5.LE.D} and that our test functions vanish on the Dirichlet boundary. However, because we use a regular Cartesian grid that does not conform to the actual domain, it is not convenient to directly define a finite element space with a specific value at the irregular boundary. Instead, we enforce these conditions weakly (cf. \eqref{eq:ch5.augmented.weak}):
\begin{center}
Find $(\bfu,p) \in (H^1(\Omega))^d \times L^2(\Omega)$, such that
\end{center}
\begin{subequations} \label{eq:ch5.dirichlet.weak}
\begin{align}
& \int_{\Omega} 2 \mu \lrp{\frac{\nabla \bfu + (\nabla \bfu)^t}{2}} : \lrp{\frac{\nabla \bfv + (\nabla \bfv)^t}{2}} - \mu p (\nabla \cdot \bfv) d\bfx \\
& \qquad = -\int_{\Omega} \bff \cdot \bfv d\bfx + \int_{\dOmega_n} \bfg \cdot \bfv d\bfS(\bfx) \quad \forall \bfv \in (H^1_{0,\dOmega_d}(\Omega))^d, \\
& \int_{\Omega} \lrp{-\mu q \nabla \cdot \bfu - \frac{\mu^2}{\lambda} p q} d\bfx = 0 \quad \forall q \in L^2(\Omega), \\
& \int_{\dOmega_d} \bfu \cdot \bfw d\bfS(\bfx) = \int_{\dOmega_d} \bfu_0 \cdot \bfw d\bfS(\bfx) \quad \forall \bfw \in (H^{-1/2}(\dOmega_d))^d. \label{eq:ch5.dirichlet.constraint.continuous}
\end{align}
\end{subequations}
Here, we introduce the Dirichlet condition as a (weak) constraint. Specifically, we require that the $L^2$ inner product of the solution and an arbitrary function $\bfw \in (H^{-1/2}(\dOmega_d))^d$ is the same as the inner product of the Dirichlet data $\bfu_0$ with $\bfw$. This makes the problem a constrained minimization.

\subsection{Discretizing the Dirichlet Problem} \label{subsec:ch5.dirichlet.discretization}

We discretize the Dirichlet constraints in a similar manner as that described in Chapter~\ref{ch:pt2.poisson}, \S\ref{subsec:ch4.discretization.dirichlet}. We approximate $(H^{-1/2}(\dOmega_d))^d$ with a subspace $\Lambda_x^h \times \Lambda_y^h := P_0(\calT^{x} \cap \dOmega_d^h) \times P_0(\calT^y \cap \dOmega_d^h)$, which is composed of piecewise constant functions over $x$ and $y$ component grid cells that intersect the Dirichlet boundary. Here we use $\dOmega_d^h$ to denote the portion of $\dOmega^h$ over which the Dirichlet constraints are being enforced. We call any $x$ or $y$ cell $T^i$ with $T^i \cap \dOmega^h \neq \emptyset$ a boundary cell. The superscript $i$ is used to denote whether the cell is in the $x$ or $y$ grids with $i = 1$ signifying an $x$ cell and $i = 2$ signifying a $y$ cell. We use $\set{\bfw_{T^i} := \chi_{T^i} \bfe_i}$ as the basis functions for $\Lambda_x^h \times \Lambda_y^h = P_0(\calT^x \cap \dOmega_d^h) \times P_0(\calT^y \cap \dOmega_d^h)$. Here, $\chi_{T^i}$ is the characteristic function of the cell $T^i$:
\begin{equation*}
\chi_{T^i}(\bfx) := \begin{cases} 1, & \bfx \in T^i \\ 0, & \bfx \notin T^i \end{cases}.
\end{equation*}
Note that we have one basis function per boundary $x$ cell and one per $y$ cell. If we use $N^d_x$ and $N^d_y$ to denote the number of $x$ and $y$ boundary cells, respectively, we can see that the dimension of the space $\Lambda_x^h \times \Lambda_y^h$ is $N^d_x + N^d_y$.

With this approximation, the discretized Dirichlet constraint can be expressed as a linear system $B \bfu^h = \bfu_0^h$ ($B \in \bbR^{(N^d_x + N^d_y) \times (N_x + N_y)}$, $\bfu_0^h \in \bbR^{N^d_x+N^d_y}$). Each equation enforces an integral constraint over the intersection of the discrete boundary $\dOmega_d^h$ with some $x$ or $y$ boundary cell $T^i$:
\begin{equation} \label{eq:ch5.dirichlet.constraint.discrete}
\sum_{k_i \in I_i} u^i_{k_i} \int_{T^i \cap \dOmega_d^h} N^i_{k_i} d\bfS(\bfx) = \int_{T^i \cap \dOmega_d^h} u^i_0 d\bfS(\bfx),
\end{equation}
where $\bfu_0 =: (u^1_0,u^2_0)$. In practice, similar to the integrals discussed in \S\ref{subsec:ch5.implementation}, we evaluate the above integrals for a given boundary cell $T^i$ from the four quadrants of $T^i$ arising from the doubly refined subgrid (see \S\ref{subsec:ch5.discretization.geometry}).

The discrete constrained minimization problem may be formulated as an equivalent saddle point system involving Lagrange multipliers:
\begin{equation} \label{eq:ch5.kkt.augmented}
\begin{pmatrix} A_u & G^t & B^t \\ G & D_p & 0 \\ B & 0 & 0 \end{pmatrix}
\begin{pmatrix} \vec{u} \\ \vec{p} \\ \vec{\lambda} \end{pmatrix}
= \begin{pmatrix} \vec{f} \\ \vec{0} \\ \vec{u}_0 \end{pmatrix}.
\end{equation}
We have one Lagrange multiplier degree of freedom per discrete Dirichlet constraint; that is, $\vec{\lambda} \in \bbR^{N^d_x + N^d_y}$. When we consider boundary equations in the sections that follow, we temporarily eliminate pressure degrees of freedom $\vec{p}$ with the substitution $A := A_u - G^t D_p^{-1} G$:
\begin{equation} \label{eq:ch5.kkt.unaugmented}
\begin{pmatrix} A & B^t \\ B & 0 \end{pmatrix}
\begin{pmatrix} \vec{u} \\ \vec{\lambda} \end{pmatrix}
= \begin{pmatrix} \vec{f} \\ \vec{u}_0 \end{pmatrix}.
\end{equation}
Although this latter system is extremely ill-conditioned in the nearly incompressible regime, it will simplify the exposition of the forthcoming discussion of Dirichlet boundary condition treatment. Furthermore, our multigrid algorithms make use of this elimination near the boundary during relaxation.

Ultimately, we use a constraint aggregation algorithm similar to that described in Chapter~\ref{ch:pt2.poisson}, \S\ref{subsubsec:ch4.constraintaggregation}, to reformulate the discretized Dirichlet constraints. But before continuing, we would like to point out a couple important details related to the constraint matrix $B$ (cf. \S\ref{subsec:ch4.discretization.dirichlet}).

\begin{itemize}

\item $B \in \bbR^{(N^d_x + N^d_y) \times (N_x + N_y)}$, and $N^d_x + N^d_y \ll N_x + N_y$, so the presence of $B$ in \eqref{eq:ch5.kkt.augmented} or \eqref{eq:ch5.kkt.unaugmented} only directly affects a small subset of the $N_x + N_y$ displacement degrees of freedom.

\item $B$ consists of two decoupled blocks: one for the $x$ boundary equations and one for the $y$ boundary equations:
\begin{equation} \label{eq:ch5.BxBy}
B = \begin{pmatrix} B_x & 0 \\ 0 & B_y \end{pmatrix},
\end{equation}
where $B_x \in \bbR^{N^d_x \times N_x}$ and $B_y \in \bbR^{N^d_y \times N_y}$. Further, the only nonzero columns of $B$ are associated with vertices incident to an $x$ or $y$ boundary grid cell. Therefore, for sufficiently interior degrees of freedom, the saddle point system \eqref{eq:ch5.kkt.augmented} is exactly the same as \eqref{eq:ch5.LEsystem.augmented.discrete}.

\end{itemize}

As in Chapter~\ref{ch:pt2.poisson}, and specifically motivated in \S\ref{subsubsec:ch4.nullspacemethod}, we reduce the saddle point system \eqref{eq:ch5.kkt.unaugmented} by eliminating the Lagrange multiplier $\vec{\lambda}$ via a \emph{null space method} using a \emph{fundamental basis} of the constraint matrix $B$. The discussion from \S\ref{subsubsec:ch4.nullspacemethod} carries over almost entirely without modification to the present setting. To summarize, we aim to construct a matrix $Z \in \bbR^{(N_x + N_y) \times ((N_x + N_y) - (N^d_x + N^d_y))}$ whose columns span the null space of $B$ and a vector $\vec{c} \in \bbR^{N_x + N_y}$ satisfying the constraint system $B \vec{c} = \vec{u}_0$. Given such a $Z$ and $\vec{c}$, we may solve \eqref{eq:ch5.kkt.unaugmented} by first solving for $\vec{v} \in \bbR^{(N_x + N_y) - (N^d_x + N^d_y)}$ in
\begin{equation} \label{eq:ch5.ztaz}
Z^tAZ \vec{v} = Z^t \lrp{\vec{f} - A \vec{c}}
\end{equation}
and setting $\vec{u} = \vec{c} + Z \vec{v}$. We construct $Z$ and $\vec{c}$ by reordering the degrees of freedom such that the leading square block of $B$ is easily invertible (indeed, as in Chapter~\ref{ch:pt2.poisson}, diagonal!), say, $B = (B_m | B_{n-m})$, and setting
\begin{equation*} \label{eq:ch5.Zc}
Z := \begin{pmatrix} -B_m^{-1} B_{n-m} \\ I_{n-m} \end{pmatrix}, \quad \vec{c} := \begin{pmatrix} B_m^{-1} \vec{u}_0 \\ 0_{n-m} \end{pmatrix}.
\end{equation*}
Note that the reordering of the degrees of freedom only makes the notation more convenient and, in practice, is not done explicitly.

It turns out that, as for the $\Lambda^h_1$-induced (i.e., \emph{single-wide}) constraints from Chapter~\ref{ch:pt2.poisson}, the present discretization \eqref{eq:ch5.dirichlet.constraint.discrete} given above of the Dirichlet constraint \eqref{eq:ch5.dirichlet.constraint.continuous} does not readily lend itself to constructing a fundamental basis matrix $Z$ of $B$ (see \S\ref{subsubsec:ch4.constraintaggregation}). Additionally, while the $\Lambda^h_2$-induced (i.e., \emph{double-wide}) constraints from \S\ref{subsubsec:ch4.constraintaggregation} and \cite{Bedrossian10} appear to yield an adequately conditioned linear system for Poisson in $2$ dimensions, the analogous discrete constraints in the present context of nearly incompressible linear elasticity yield a relatively poorly conditioned linear system, similar to the situation of Poisson in $3$ dimensions (see Appendix~\ref{ch:pt2.appendix.constraintconditioning} for a specific example). We instead reformulate our discretization of \eqref{eq:ch5.dirichlet.constraint.continuous} using a constraint aggregation algorithm nearly identical to that described in \S\ref{subsubsec:ch4.constraintaggregation} and Algorithm~\ref{alg:ch4.dirichlet.constraintaggregation}. Indeed, since the $B_x$ and $B_y$ blocks from \eqref{eq:ch5.BxBy} are decoupled, one may aggregate each discrete constraint set independently, and each of these aggregations is identical to the case for Poisson Dirichlet constraints described in \S\ref{subsubsec:ch4.constraintaggregation} and Algorithm~\ref{alg:ch4.dirichlet.constraintaggregation}. We henceforth presume the aggregation of the single-wide constraints \eqref{eq:ch5.dirichlet.constraint.discrete} into \emph{aggregate constraints}.

\section{Multigrid} \label{sec:ch5.multigrid}

We develop an efficient multigrid framework for the discrete linear system \eqref{eq:ch5.kkt.augmented} / \eqref{eq:ch5.kkt.unaugmented}. Our method is purely geometric and based on the Multigrid Correction Scheme (see Algorithm~\ref{alg:ch5.multigrid}). The framework admits a simple implementation, and at a high level, it is very similar to that described in Chapter~\ref{ch:pt2.poisson}, \S\ref{sec:ch4.multigrid}. However, in contrast \S\ref{sec:ch4.multigrid}, the following multigrid components are significantly more sophisticated and customized to the present discretization, which is necessary to retain near-textbook multigrid convergence rates in the presence of highly irregular domains or near the incompressible limit. The subsections that follow will detail the key components of our multigrid algorithm: a hierarchy of discretizations, a smoothing operator, and appropriate transfer operators (i.e., restriction and prolongation) between levels of the hierarchy.

\begin{algorithm}[htbp]
\caption{Multigrid Defect Correction}
\label{alg:ch5.multigrid}
\begin{algorithmic}[1]
\STATE \textbf{function} $\operatorname{V-Cycle} \lrp{\tilde{A}^h, \tilde{u}^h, \tilde{f}^h}$ \textbf{:}
\IF{resolution is low enough}
    \STATE $\tilde{u} \leftarrow \lrp{\tilde{A}^h}^{-1} \tilde{f}^h$
    \RETURN
\ENDIF
\STATE $\operatorname{Pre-Relaxation} \lrp{\tilde{A}^h, \tilde{u}^h, \tilde{f}^h}$
\STATE $\tilde{f}^{2h} \leftarrow R_h^{2h} \lrp{\tilde{f}^h - \tilde{A}^h \tilde{u}^h}$ \COMMENT{Restriction}
\STATE $\operatorname{V-Cycle} \lrp{\tilde{A}^{2h}, \tilde{u}^{2h}, \tilde{f}^{2h}}$
\STATE $\tilde{u}^h \leftarrow \tilde{u}^h + P_{2h}^h \tilde{u}^{2h}$ \COMMENT{Prolongation}
\STATE $\operatorname{Post-Relaxation} \lrp{\tilde{A}^h, \tilde{u}^h, \tilde{f}^h}$
\RETURN
\end{algorithmic}
\end{algorithm}

\subsection{Discretization Hierarchy}

We consider a hierarchy of grids, each corresponding to a discretization of \eqref{eq:ch5.dirichlet.weak} at a progressively larger grid resolutions. In particular, we employ a grid spacing of $h$ on the finest level of the hierarchy (level index zero), followed by discretizations with grid spacings of $2h, 4h, \dotsc, 2^Lh$, for a total of $L+1$ grid levels. In detail, we construct the hierarchy as follows:

\begin{itemize}

\item At level $\ell$ of the hierarchy we define the background grids $\calG^x_{2^{\ell}h}, \calG^y_{2^{\ell}h}, \calG^p_{2^{\ell}h}$ corresponding to the $x$, $y$, and $p$ degrees of freedom, respectively.

\item We sample the level set function implicitly defining $\Omega$ over the respective doubly refined subgrids $\calG^\phi_h, \calG^\phi_{2h}, \calG^\phi_{4h}, \dotsc$ at each level. Clearly, coarser grids may fail to resolve some high frequency features of the domain geometry, leading to possible incoherency between the discrete systems at neighboring levels. We will addressed such issues in our discussion of the smoothing and transfer operators.

\item Using the level set function values associated with a given grid, we generate the discretized domains $\calT^x_{2^{\ell}h}, \calT^y_{2^{\ell}h}, \calT^p_{2^{\ell}h}$ and allocate the arrays of unknowns $\vec{u}^{2^{\ell}h}, \vec{p}^{2^{\ell}h}$ and right-hand sides $\vec{f}^{2^{\ell}h}, \vec{f}_p^{2^{\ell}h}$ of the respective equations. The discrete operators $A_u^{2^{\ell}h}, \linebreak[0] G^{2^{\ell}h}, \linebreak[0] D_p^{2^{\ell}h}$ of the system \eqref{eq:ch5.LEsystem.augmented.discrete} are likewise defined on the discretized domain associated with hierarchy level $\ell$, following the same process detailed in \S\ref{subsec:ch5.discretization}. Note that although $\vec{f}_p^h \equiv \vec{0}$ at the finest level of our hierarchy (at least initially), the right hand side $\vec{f}_p^{2^{\ell}h}$ at coarser levels ($\ell \geq 1$) will generally be nonzero in the Multigrid Correction Scheme (see Algorithm~\ref{alg:ch5.multigrid}).

\end{itemize}

From this point on, we will simply use $h$ instead of $2^{\ell}h$ to denote the grid spacing at any specific level of the multigrid hierarchy, whenever this does not incur any ambiguity. In the presence of a Dirichlet boundary condition \eqref{eq:ch5.LE.D}, we construct an \emph{aggregate constraint matrix} $B$ at each level, as summarized in \S\ref{subsec:ch5.dirichlet.discretization} and detailed in Chapter~\ref{ch:pt2.poisson}, \S\ref{subsubsec:ch4.constraintaggregation}. Each row of $B$ corresponds to one Lagrange multiplier. Following the null space method (again, summarized in \S\ref{subsec:ch5.dirichlet.discretization} and detailed in \S\ref{subsubsec:ch4.nullspacemethod}), we eliminate these multipliers by solving for the null basis coefficients $\vec{v}$ in $\vec{u} = \vec{c} + Z \vec{v}$. By definition \eqref{eq:ch5.Zc} of $\vec{c}$ and $Z$, there is a one-to-one mapping between $\vec{v}$ components and $x$ and $y$ degrees of freedom which are not independent (recall that the independent degrees of freedom correspond to the leading diagonal block $B_m$ of $B$; see Chapter~\ref{ch:pt2.poisson}, \S\ref{subsubsec:ch4.constraintaggregation}). Thus, the reduced system \eqref{eq:ch5.ztaz} is defined precisely over all non-independent degrees of freedom. Due to the fact that the reconstructed $\vec{u} := \vec{c} + Z \vec{v}$ satisfies the (aggregate) constraint equations automatically, we need not restrict any residuals for the constraint system. Further, we need not solve for $\vec{\lambda}$, thanks to our null space method, hence do not store any $\vec{\lambda}$ components nor prolongate any $\vec{\lambda}$ corrections. When we restrict the residuals of the governing equation, i.e., $\vec{r} = \vec{f} - A \vec{u} - B \vec{\lambda}$, we simply restrict zero for all equations that involve a $\vec{\lambda}$ component. In other words, we restrict zero residuals from equations involving any $x$ or $y$ degrees of freedom on an $x$ or $y$ boundary grid cell, respectively. Although omitting these equations from the intergrid transfers is a deviation from conventional practice, we compensate by moderately increasing the pre-restriction smoothing effort in a boundary band, effectively driving the residuals in this band very close to zero (which is the value that is actually restricted!). This approach avoids the use of specialized, elaborate transfer operators involving the $\vec{\lambda}$ variables, which are not in perfect correspondence between neighboring levels due to the independent constraint aggregations employed at each level. Note that this aspect of our multigrid framework is the same as that in Chapter~\ref{ch:pt2.poisson}, \S\ref{sec:ch4.multigrid}.

\subsection{Relaxation}

The interior equations are uniform and have the same properties, while near the boundary, the equations have very different stencils. In order to design a stable and efficient relaxation scheme while keeping the computational cost low, we define two (overlapping) sets of equations, and apply an appropriate relaxation subscheme to each one. The two sets correspond to equations in the interior of the discretized domain and equations near the boundary, respectively. We define the extent of the interior region by excluding $5 \times 5$ blocks of cells, each centered around any cell that intersects the Dirichlet boundary. See Figure~\ref{fig:ch5.boundaryband}(b) for an example using $1 \times 1$ cell blocks. This interior region is relaxed with the distributive process detailed in \S\ref{subsubsec:ch5.multigrid.relaxation.distributive}.

We then define the boundary band to be the union of all $7 \times 7$ blocks of cells centered at any cell that intersects the Dirichlet boundary (excluding any cells completely exterior to the domain). This defines the set of equations to which we will apply our boundary relaxation scheme. In each single level relaxation, we first sweep over the boundary band, apply a few iterations of boundary relaxations, then apply one iteration of interior relaxation, and finally follow this by another few iterations of boundary relaxations. In Figure~\ref{fig:ch5.boundaryband}(a), we show an example of the cells and equations that end up in a boundary region calculated with the method described above. Soely for the sake of example, due to the coarseness of the illustrated grid, Figure~\ref{fig:ch5.boundaryband} uses $3 \times 3$ cell blocks rather than the $7 \times 7$ cell blocks used in our examples.

\setlength{\figureheight}{0.40\columnwidth}
\begin{figure}[htbp]
\begin{center}
\subfigure[An example boundary band of pressure cells and boundary variables using $3 \times 3$ blocks of cells centered at each cell that intersects the boundary.]
{\includegraphics[height=\figureheight]{part2/chapter5/figures/bw/grid_bdryband_new.png}}
\subfigure[An example of distributive pressure cells and variables relaxed using distributive relaxation. This example region is defined by excluding $1 \times 1$ blocks of cells (i.e., a single cell) centered at each cell intersecting the boundary.]
{\includegraphics[height=\figureheight]{part2/chapter5/figures/bw/grid_dist_final.png}}
\caption{Boundary band and distributive region.}
\label{fig:ch5.boundaryband}
\end{center}
\end{figure}

The efficiency of a multigrid algorithm is closely related to the smoothing efficiency of a single level relaxation. With Poisson's equation, simple Jacobi or Gauss-Seidel will typically suffice as an efficient smoother. These techniques effectively reduce the high-frequency components of the error and make it possible for a coarse grid to provide a meaningful correction to a fine grid. This property is fundamentally important for the efficiency of the geometrically hierarchical approach. Unfortunately, the equations of nearly incompressible linear elasticity with augmented pressure require more care than the comparably simplistic discrete Poisson equation (cf. Chapter~\ref{ch:pt2.poisson}). Although our system is not symmetric positive definite, we can reformulate the equations in a more convenient form as in \cite{Zhu.Yongning10} to design an effective geometric multigrid smoother. Indeed, our change of variables leads to an approximate block triangularization of the discrete system with each diagonal block being a symmetric semi-definite discretization of the Laplacian. Our smoother is then constructed to be an application of the Gauss-Seidel relaxation on each block.

\subsubsection{Approximate distributive relaxation} \label{subsubsec:ch5.multigrid.relaxation.distributive}

We follow the idea in \cite{Zhu.Yongning10} and develop a \emph{distributive relaxation scheme}. We apply the following transformation on the continuous variable $\tilde{\bfu} := (\bfu \; p)$:
\begin{equation} \label{eq:ch5.distributive.transform}
\begin{pmatrix} \bfu \\ p \end{pmatrix}
= \begin{pmatrix} \bfI & -\nabla \\ \nabla^t & -2 \Delta \end{pmatrix}
\begin{pmatrix} \bfv \\ q \end{pmatrix}
\quad \text{or} \quad
\tilde{\bfu} = \tilde{\bfM} \tilde{\bfv};
\end{equation}
substituting into \eqref{eq:ch5.augmented.strong} yields the auxiliary system
\begin{equation} \label{eq:ch5.distributive.triangularized}
\begin{pmatrix} \mu \Delta \bfI & 0 \\ \mu (1 + \mu / \lambda) \nabla^t & -\mu (1 + 2\mu / \lambda) \Delta \end{pmatrix}
\begin{pmatrix} \bfv \\ q \end{pmatrix}
= \begin{pmatrix} \bff \\ 0 \end{pmatrix}
\quad \text{or} \quad
\tilde{\bfA} \tilde{\bfM} \tilde{\bfv} = \tilde{\bff}
\end{equation}
for some auxiliary variable $\tilde{\bfv} := (\bfv \; q)$. This auxiliary system is a block lower triangular system and can be solved via forward substitution: first solve the $\bfv$ equations (which don't involve $q$), then solve for $q$ given the previously solved $\bfv$. Moreover, with an intelligent discretization, the same triangulation can be realized on the discretized system, i.e., $\tilde{A} \tilde{M}$ is also a block lower triangular linear system \cite{Zhu.Yongning10}.

Since each of the diagonal blocks of the discrete auxiliary system is a discretization of the Laplacian operator, we can relax the whole system using a Gauss-Seidel relaxation on each component of the $\vec{v}$ degrees of freedom followed by a ($3^{rd}$) Gauss-Seidel relaxation on the $\vec{q}$ degrees of freedom and achieve the same smoothing efficiency as Gauss-Seidel relaxation simply applied to Poisson's equation. Note that given any $\vec{v}$ and $\vec{q}$, one can reconstruct $\vec{u}$ and $\vec{p}$ via the discrete form of \eqref{eq:ch5.distributive.transform}.

In practice, we never explicitly construct $\tilde{v} := (\vec{v} \; \vec{q})$. In a Gauss-Seidel relaxation applied to $\tilde{v}$, we iteratively solve for local corrections $\tilde{v}_i \leftarrow \tilde{v}_i + \delta \tilde{e}_i$, such that the local residual $\tilde{r}_i := (\tilde{f} - \tilde{A} \tilde{M} \tilde{v})_i$ is zeroed out. From this, we see that $\delta = \tilde{r}_i / (\tilde{A} \tilde{M})_{ii}$. Such local corrections to $\tilde{v}$ induce local, \emph{distributive} corrections to $\tilde{u}$ as well via the discrete form of \eqref{eq:ch5.distributive.transform}: $\tilde{u}_i \leftarrow \tilde{u}_i + \delta \tilde{M} \tilde{e}_i$. This analysis is encapsulated in Algorithm~\ref{alg:ch5.distributive}.

\begin{algorithm}[htbp]
\caption{Distributive relaxation.}
\label{alg:ch5.distributive}
\begin{algorithmic}[1]
\STATE \textbf{function} $\operatorname{DistributiveSmooth} \lrp{\tilde{A}, \tilde{M}, \tilde{u}, \tilde{f}}$ \textbf{:}
\FOR{$\vec{w} \in \set{\vec{u}^1, \vec{u}^2, \vec{p}}$}
    \FOR{$i \in \operatorname{Lattice}(\vec{w})$}
        \STATE $r \leftarrow \tilde{f}_i - \tilde{A} \tilde{u}$
        \STATE $\delta \leftarrow r / (\tilde{A} \tilde{M})_{ii}$
        \STATE $\tilde{u} \plusequal \delta \tilde{M} \tilde{e}_i$
    \ENDFOR
\ENDFOR
\end{algorithmic}
\end{algorithm}

For a staggered finite difference discretization, the triangularization of the discretized system can be effected by discretizing the transformation operator $\tilde{\bfM}$ in \eqref{eq:ch5.distributive.transform} using centered
differences for the gradient and divergence operators and the standard $5$-point stencil for the Laplacian operator \cite{Zhu.Yongning10}. Unfortunately, when one uses a finite element discretization, there exists no discrete change of variables with the same sparsity that leads to an exact triangularization. Instead, we discretize the gradient operator in
\eqref{eq:ch5.distributive.transform} using the stencils derived from a finite element method, i.e.,
\begin{equation*}
\nabla \approx \frac{1}{\mu h^2} G^t = \begin{pmatrix} D_x \\ D_y \end{pmatrix},
\end{equation*}
which maps $p$ degrees of freedom onto $x$ and $y$ degrees of freedom with the locations illustrated in Figure~\ref{fig:ch5.stiffnessmatrix.global}(right) and stencils as
\begin{equation*}
D_x := \frac{1}{h}
\left] \begin{matrix} -1/8 & +1/8 \\ -3/4 & +3/4 \\ -1/8 & +1/8 \end{matrix} \right[, \quad
D_y := \frac{1}{h}
\left] \begin{matrix} +1/8 & +3/4 & +1/8 \\ -1/8 & -3/4 & -1/8 \end{matrix} \right[.
\end{equation*}
Similarly, the Laplacian operator in \eqref{eq:ch5.distributive.transform} is discretized from a standard piecewise bilinear finite element discretization:
\begin{equation*}
M_p := \frac{1}{h^2} \left] \begin{matrix} +1/3 & +1/3 & +1/3 \\ +1/3 & -8/3 & +1/3 \\ +1/3 & +1/3 & +1/3 \end{matrix} \right[.
\end{equation*}

Although the linear system $\tilde{A} \tilde{M}$ is not strictly block triangular, our numerical results in \S\ref{sec:ch5.examples} show that the derived distributive relaxation is able to reduce the high-frequency error components efficiently.

\subsubsection{High order defect correction} \label{subsubsec:ch5.multigrid.relaxation.defectcorrection}

We can decrease the cost of our distributive relaxation via \emph{high order defect correction}. To introduce the idea, suppose we wish to solve the linear system $L \vec{u} = \vec{f}$ for the unknown $\vec{u}$. In a \emph{defect correction} scheme, we solve for a correction $\delta\vec{u}$ to a current approximation $\vec{u}$ via some alternate, typically easier system $L' \delta\vec{u} = \vec{f} - L \vec{u}$. For example, in a multigrid correction scheme with $L$ a fine grid operator, $L'$ (roughly) corresponds to the coarse grid operator. In a \emph{high order} defect correction scheme, a lower order discretization alternate system is used to to solve for a higher order discretization correction. In our case, the lower order operator is based on a finite difference approximation while the high order operators corresponds to our finite element discretization described in \S\ref{subsec:ch5.discretization}. In other words, we solve the following correction equation:
\begin{equation*}
\tilde{A}^{\text{FD}} \delta\tilde{u} = \tilde{f} - \tilde{A}^{\text{FEM}} \tilde{u}.
\end{equation*}
We use the staggered finite difference operator $\tilde{A}^{\text{FD}}$ detailed in \cite{Zhu.Yongning10}. Note that this operator is only lower order near the boundary; indeed, it is still second order in the interior. However, we still use this finite difference operator as the lower order operator in the defect correction scheme, even when focused on the domain interior.

One of the benefits we obtain from such an approximation is that we can use the distributive relaxation described above with an exact triangulation of the discretized system \eqref{eq:ch5.distributive.triangularized}. To be specific, let us write the finite difference system as
\begin{equation*}
\tilde{A}^{\text{FD}} \tilde{u} =
\begin{pmatrix} A_u^{\text{FD}} & (G^{\text{FD}})^t \\ G^{\text{FD}} & D_p^{\text{FD}} \end{pmatrix}
\begin{pmatrix} \vec{u}^{\text{FD}} \\ \vec{p}^{\text{FD}} \end{pmatrix}, \quad
\tilde{f}^{\text{FD}} = \begin{pmatrix} \vec{f}^{\text{FD}} \\ \vec{0} \end{pmatrix},
\end{equation*}
and scale finite element system by $1/h^2$ to match the scaling of the both the finite difference equation and the differential equation:
\begin{equation*}
\frac{1}{h^2} \tilde{A}^{\text{FEM}} \tilde{u} =
\frac{1}{h^2} \begin{pmatrix} A_u^{\text{FEM}} & (G^{\text{FEM}})^t \\ G^{\text{FEM}} & D_p^{\text{FEM}} \end{pmatrix}
\begin{pmatrix} \vec{u}^{\text{FEM}} \\ \vec{p}^{\text{FEM}} \end{pmatrix}, \quad
\frac{1}{h^2} \tilde{f}^{\text{FEM}} = \frac{1}{h^2} \begin{pmatrix} \vec{f}^{\text{FEM}} \\ \vec{0} \end{pmatrix}.
\end{equation*}
(Note that $\tilde{A}^{\text{FEM}}$ is precisely the operator $\tilde{A}$ defined in \eqref{eq:ch5.LEsystem.augmented.discrete}, and similarly for the other variables marked with $\cdot^{\text{FEM}}$; we only add the superscript to emphasize the difference with the $\cdot^{\text{FD}}$ variables.) We thus solve for a correction $\delta\tilde{u} = \tilde{M}^{\text{FD}} \delta\tilde{v}$ via
\begin{equation*}
\tilde{A}^{\text{FD}} \tilde{M}^{\text{FD}} \delta\tilde{v} = \frac{1}{h^2} \lrp{\tilde{f}^{\text{FEM}} - \tilde{A}^{\text{FEM}} \tilde{u}^{\text{current}}}.
\end{equation*}
This induces a sparser distributive relaxation scheme; the details are given in Algorithm~\ref{alg:ch5.distributive.defectcorrection}.

\begin{algorithm}[htbp]
\caption{Distributive relaxation with \emph{finite difference defect correction} (FDDC).}
\label{alg:ch5.distributive.defectcorrection}
\begin{algorithmic}[1]
\STATE \textbf{function} $\operatorname{DistributiveSmoothWithFDDC} \lrp{\tilde{A}^{\text{FD}}, \tilde{M}^{\text{FD}}, \tilde{A}^{\text{FEM}}, \tilde{M}^{\text{FEM}}, \tilde{u}, \tilde{f}^{\text{FEM}}}$ \textbf{:}
\FOR{$\vec{w} \in \set{\vec{u}^1, \vec{u}^2, \vec{p}}$}
    \FOR{$i \in \operatorname{Lattice}(\vec{w})$}
        \STATE $r \leftarrow \tilde{f}^{\text{FEM}}_i - \tilde{A}^{\text{FEM}} \tilde{u}$
        \STATE $\delta \leftarrow r / (\tilde{A}^{\text{FD}} \tilde{M}^{\text{FD}})_{ii}$
        \STATE $\tilde{u} \plusequal \delta \tilde{M}^{\text{FD}} \tilde{e}_i$
    \ENDFOR
\ENDFOR
\end{algorithmic}
\end{algorithm}

\subsubsection{Boundary relaxation}

Neither of the distributive relaxation algorithms discussed in the previous subsubsections may be applied near the domain boundary as some variables in the distribution stencil may not even exist. Instead, we follow \cite{Zhu.Yongning10} and temporarily build an unaugmented system in the boundary band (e.g., see Figure~\ref{fig:ch5.boundaryband}(a)). In the case of Neumann boundary condition, we eliminate $\vec{p}$ from the augmented system \eqref{eq:ch5.LEsystem.augmented.discrete} by left multiplying by
\begin{equation*}
\tilde{U} := \begin{pmatrix} I & -G^t D_p^{-1} \\ 0 & I \end{pmatrix}
\end{equation*}
yielding
\begin{equation} \label{eq:ch5.LEsystem.unaugmented.discrete}
\tilde{U} \tilde{f} = \tilde{U} \tilde{A} \tilde{u} =
\begin{pmatrix} A_u - G^t D_p^{-1} G & 0 \\ G & D_p \end{pmatrix}
\begin{pmatrix} \vec{u} \\ \vec{p} \end{pmatrix}.
\end{equation}
In the first equation for $\vec{u}$, the equation is symmetric and positive definite, and hence can be solved by using, e.g., Gauss-Seidel relaxation. This unaugmented system is a consistent discretization to the original PDE \eqref{eq:ch5.augmented.strong}. Although Gauss-Seidel relaxation is not an efficient smoother for the unaugmented system if defined everywhere, for the purposes of boundary relaxation, we only build the unaugmented system temporarily, relax it within a very narrow boundary band, as in Figure~\ref{fig:ch5.boundaryband}, and temporarily freeze the interior degrees of freedom. The solution is strongly restricted by nearby interior values, so Gauss-Seidel relaxation is still efficient and stable. Typically, with about $5$ to $10$ boundary relaxation sweeps before and after each interior relaxation sweep, the boundary residual is reduced to as small as the interior residual. Once we have relaxed $\vec{u}$ sufficiently, we freeze $\vec{u}$ and substitute into the second equation of \eqref{eq:ch5.LEsystem.unaugmented.discrete} to relax the pressure degrees of freedom.

\subsubsection{Boundary relaxation with Dirichlet boundary conditions}

In the case of Dirichlet boundary conditions, the system \eqref{eq:ch5.kkt.unaugmented} is strongly indefinite and cannot be relaxed using, e.g., Gauss-Seidel. Alternative approaches such as Kaczmarz relaxation or box relaxation may be efficient smoothers; however, they have a high computational cost. Instead, we utilize the fundamental basis of the constraint matrix to solve $\vec{v}$ in the $Z^tAZ$ system \eqref{eq:ch5.ztaz} and then reconstruct $\vec{u}$ in \eqref{eq:ch5.kkt.unaugmented} via $\vec{u} := \vec{c} + Z \vec{v}$. Since $Z^tAZ$ is symmetric positive definite (see Chapter~\ref{ch:pt2.poisson}, \S\ref{subsubsec:ch4.nullspacemethod}), one may confidently apply Gauss-Seidel relaxation; see Algorithm~\ref{alg:ch5.relaxation.boundary.dirichlet.v} and compare Chapter~\ref{ch:pt2.poisson}, \S\ref{subsec:ch4.multigrid.smoothing}.

\begin{algorithm}[htbp]
\caption{Boundary relaxation with Dirichlet boundary conditions - $\vec{v}$.}
\label{alg:ch5.relaxation.boundary.dirichlet.v}
\begin{algorithmic}[1]
\STATE $\vec{v} \leftarrow \vec{0}$
\FOR{$i = 1, \dotsc, m$}
    \STATE $\delta \leftarrow \vec{e}_i^t Z^t \lrp{\vec{f} - A \vec{c} - AZ \vec{v}} / A_{ii}$
    \STATE $\vec{v} \plusequal \delta \vec{e}_i$
\ENDFOR
\end{algorithmic}
\end{algorithm}

In practice, a Gauss-Seidel iteration on \eqref{eq:ch5.ztaz} iteratively solves for a correction on each single degree of freedom by solving the scalar equation
\begin{equation*}
\vec{e}_i^t Z^tAZ \lrp{\vec{v} + \delta \vec{e}_i} = \vec{e}_i^t Z^t \lrp{\vec{f} - A \vec{c}},
\end{equation*}
i.e.,
\begin{align*}
A_{ii} \delta & = \vec{e}_i^t Z^t \lrp{\vec{f} - A \vec{c} - A Z \vec{v}} \\
              & = \vec{e}_i^t Z^t \lrp{\vec{f} - A \vec{u}},
\end{align*}
and then applying the correction $\vec{v} \leftarrow \vec{v} + \delta \vec{e}_i$. Equivalently, one may update the $\vec{u}$ degrees of freedom directly: $\vec{u} \leftarrow \vec{u} + \delta Z \vec{e}_i$; see Algorithm~\ref{alg:ch5.relaxation.boundary.dirichlet.v}.

\begin{algorithm}[htbp]
\caption{Boundary relaxation with Dirichlet boundary conditions - $\vec{u}$.}
\label{alg:ch5.relaxation.boundary.dirichlet.v}
\begin{algorithmic}[1]
\STATE $\vec{u} \leftarrow \vec{c}$
\FOR{$i = 1, \dotsc, m$}
    \STATE $\delta \leftarrow \vec{e}_i^t Z^t \lrp{\vec{f} - A \vec{u}} / A_{ii}$
    \STATE $\vec{u} \plusequal \delta Z \vec{e}_i$
\ENDFOR
\end{algorithmic}
\end{algorithm}

\subsection{Coarsening} \label{subsec:ch5.multigrid.coarsening}

In contrast to our smoothing operator discussed in the preceding subsections, our grid transfer operators are relatively straightforward. On the interior of the domain, we restrict fine grid residuals to the coarse grid by applying a restriction operator $R$ with the stencils illustrated in Figure~\ref{fig:ch5.restriction}. We consider two kinds of prolongation operators for our numerical examples in \S\ref{subsec:ch5.examples.multigrid}. First, we consider simply the transpose of the restriction operator: $P_{\text{lo}} := 4 R^t$. Second, we also consider piecewise bilinear interpolation for $\vec{u}$ in combination with the same pressure prolongation given by $P_{\text{lo}}$, which we denote as $P_{\text{hi}}$.

\setlength{\unitlength}{1.2cm}
\begin{figure}[htbp]
\begin{center}
\footnotesize\begin{picture}(4,4)
  \linethickness{1.5pt}
  \multiput(0,0)(0, 2){3}{\line(1, 0){4}}
  \multiput(0,0)(2,0){3}{\line(0, 1){4}}
  \linethickness{0.5pt}
  \multiput(0,0)(0, 1){5}{\multiput(0,0)(.1,0){40}{\line(1,0){.05}}}
  \multiput(0,0)(1,0){5}{\multiput(0,0)(0,.1){40}{\line(0,1){.05}}}
\put(0,1){
  \put(1.87,1.93){\colorbox{white}{$X$}}

  \put(0.8,1.43){\colorbox{white}{$1/8$}}
  \put(1.8,1.43){\colorbox{white}{$1/4$}}
  \put(2.8,1.43){\colorbox{white}{$1/8$}}
  \put(0.8,2.43){\colorbox{white}{$1/8$}}
  \put(1.8,2.43){\colorbox{white}{$1/4$}}
  \put(2.8,2.43){\colorbox{white}{$1/8$}}
}
\end{picture}\hspace{5mm}
\begin{picture}(4,4)
  \linethickness{1.5pt}
  \multiput(0,0)(0, 2){3}{\line(1, 0){4}}
  \multiput(0,0)(2,0){3}{\line(0, 1){4}}
  \linethickness{0.5pt}
  \multiput(0,0)(0, 1){5}{\multiput(0,0)(.1,0){40}{\line(1,0){.05}}}
  \multiput(0,0)(1,0){5}{\multiput(0,0)(0,.1){40}{\line(0,1){.05}}}
\put(0,1){
  \put(.87,.93){\colorbox{white}{$Y$}}

  \put(0.25,.93){\colorbox{white}{$1/4$}}
  \put(1.25,.93){\colorbox{white}{$1/4$}}
  \put(0.25,1.93){\colorbox{white}{$1/8$}}
  \put(1.25,1.93){\colorbox{white}{$1/8$}}
  \put(0.25,-.07){\colorbox{white}{$1/8$}}
  \put(1.25,-.07){\colorbox{white}{$1/8$}}
}
\end{picture}\hspace{5mm}
\begin{picture}(4,4)
\footnotesize
  \linethickness{1.5pt}
  \multiput(0,0)(0, 2){3}{\line(1, 0){4}}
  \multiput(0,0)(2,0){3}{\line(0, 1){4}}
  \linethickness{0.5pt}
  \multiput(0,0)(0, 1){5}{\multiput(0,0)(.1,0){40}{\line(1,0){.05}}}
  \multiput(0,0)(1,0){5}{\multiput(0,0)(0,.1){40}{\line(0,1){.05}}}
\put(1,-1){
  \put(1.87,1.93){\colorbox{white}{$P$}}

  \put(1.3,1.43){\colorbox{white}{$1/4$}}
  \put(2.3,1.43){\colorbox{white}{$1/4$}}
  \put(1.3,2.43){\colorbox{white}{$1/4$}}
  \put(2.3,2.43){\colorbox{white}{$1/4$}}
}
\end{picture}
\caption{Stencils for the restriction operator $R$.}
\label{fig:ch5.restriction}
\end{center}
\end{figure}

However, near the boundary, there is no guarantee that all dependencies of the coarse grid restriction stencils are legitimate fine grid degrees of freedom. Therefore, we truncate our restriction stencils to the actual degrees of freedom, which is equivalent to restricting zero residuals from fine grid vertices which are not degrees of freedom. Also, in the presence of Dirichlet boundary conditions, we cannot compute the components of the residual $\vec{r} = \vec{f} - A \vec{u} - B^t \vec{\lambda}$ when $\vec{\lambda}$ components are nontrivially involved. In this case, we apply enough boundary relaxation sweeps to ensure these boundary residuals are smaller than interior residuals, then simply restrict zero boundary residual values for these equations. Now, normally, the right hand side to the coarse grid constraint system has been computed from the restriction of the residual of the fine grid constraint system. However, due to the fact that our solutions $\vec{u} = \vec{c} + Z \vec{v}$ always satisfy the Dirichlet boundary constraints exactly, the Dirichlet boundary condition on all coarse grids should be zero.

We implement prolongation distributively, i.e., we iterate over the coarse grid degrees of freedom and distribute a coarse grid scalar correction to all appropriate fine level degrees of freedom. Near the domain boundary this is equivalent to prolongating a zero correction from exterior coarse grid vertices, which we believe is reasonable. Notice that such a prolongation may shift the fine grid solution away from a fundamental basis solution. Hence we apply a projection onto the solution space after prolongation. We use the projection $\vec{u}' := \vec{c} + Z Q \vec{u}$ where $\vec{u}$ is the (possibly) shifted fine grid solution and $Q$ is a projection which simply removes those components corresponding to independent degrees of freedom with respect to the aggregate constraint system.

\section{Numerical Examples} \label{sec:ch5.examples}

We numerically investigate two aspects of our discretization: order of convergence and multigrid performance. In this section, we apply our method on various domains with Neumann or Dirichlet boundary conditions and with a wide range of Poisson's ratios. We considered three deformations defined on three geometric domains:

\begin{enumerate}

\item \textbf{Keyhole domain.} A Keyhole domain enclosed by a smooth curve connecting $8$ tangential circles with centers
\begin{align*}
\bfc_1 & = (0.2500, 0.2500); & \bfs_1 & = (0.5000, 0.6875); \\
\bfc_2 & = (0.7500, 0.2500); & \bfs_2 & = (0.5000, 0.3125); \\
\bfc_3 & = (0.2500, 0.7500); & \bfs_3 & = (0.3125, 0.5000); \\
\bfc_4 & = (0.7500, 0.7500); & \bfs_4 & = (0.6875, 0.5000); \\
\end{align*}
and radius $0.2$ for the ``$\bfc$'' circles and $r_s = \sqrt{17}/4 - 0.2$ for the ``$\bfs$'' circles. The radius $r_s$ is chosen such that the circle curves are tangential and hence generate a smooth boundary. The boundary of the keyhole domain can also be represented by the zero isocontour of the level set function
\begin{equation*}
\varphi(\bfx) := \max \set{ \min \set{ \alpha \lrp{\bfx, \bfzero, r_0}, \min_i \set{ \alpha \lrp{\bfx, \bfc_i, 0.2} }}, -\min_i \set{ \alpha \lrp{\bfx, \bfs_i, r_s} } }
\end{equation*}
where
\begin{equation*}
\alpha \lrp{\bfx, \bfx_0, r} := \norm{\bfx - \bfx_0} - r, \quad
r_0 := \norm{\frac{0.2}{\sqrt{17}} (4, 1) - (0.25, 0.25)}.
\end{equation*}

A constant divergence deformation is considered, giving the exact boundary conditions and the exact solution for the purpose of error computation:
\begin{align*}
\phi_1(x,y) & = 2x + \frac{1}{2} \cos \pi x \sin \pi y, \\
\phi_2(x,y) & = 2y - \frac{1}{2} \sin \pi x \cos \pi y.
\end{align*}

\setlength{\figureheight}{0.40\columnwidth}
\begin{figure}[htbp]
\begin{center}
\subfigure[Undeformed.]
{\includegraphics[trim=4cm 1cm 4cm 1cm,clip,height=\figureheight]{part2/chapter5/figures/bw/ginkgo}}
\subfigure[Deformed.]
{\includegraphics[trim=4cm 1cm 4cm 1cm,clip,height=\figureheight]{part2/chapter5/figures/bw/ginkgo_deformed}}
\caption{Keyhole domain.}
\end{center}
\end{figure}

\item \textbf{Flower domain.} A flower-shaped domain with inner radius $0.2$ and outer radius $0.4$. We represent the boundary of this domain by the zero isocontour of the level set function
\begin{equation*}
\varphi(\bfx) := \alpha \lrp{\bfx, \mathbf{0.5}, 0.3 + 0.1 \cos 5\theta},
\end{equation*}
where $\mathbf{0.5} := (0.5,0.5)$ and $\theta$ is the argument of $\bfx$. We use the following deformation with spatially varying divergence:
\begin{align*}
\phi_1(x,y) := \frac{2x}{\sqrt{\pi}} \cos \frac{\pi}{2} y, \\
\phi_2(x,y) := \frac{2x}{\sqrt{\pi}} \sin \frac{\pi}{2} y.
\end{align*}

\setlength{\figureheight}{0.40\columnwidth}
\begin{figure}[htbp]
\begin{center}
\subfigure[Undeformed.]
{\includegraphics[trim=4cm 1cm 4cm 1cm,clip,height=\figureheight]{part2/chapter5/figures/bw/flower}}
\subfigure[Deformed.]
{\includegraphics[trim=4cm 1cm 4cm 1cm,clip,height=\figureheight]{part2/chapter5/figures/bw/flower_deformed}}
\caption{Flower domain.}
\end{center}
\end{figure}

\item \textbf{Spiral domain} We represent the boundary of the spiral domain as the zero isocontour of the level set function
\begin{equation*}
\varphi(\bfx) := r(\bfy) - \lrp{0.33 + 0.08 \cos 5\theta(\bfy)^{1/3}}
\end{equation*}
where $\bfy = \bfy(\bfx)$ is $\bfx - (0.5,0.5)$ rotated around (0.5,0.5) by $\theta = 14 \lrp{2r(\bfx)}^{1/6}$. We use the deformation
\begin{align*}
\phi_1(x,y) & = \lrp{\frac{1}{2} x + \frac{1}{2}} \cos \lrp{\frac{\pi}{6} + \frac{2}{3} \pi y}, \\
\phi_2(x,y) & = \lrp{\frac{1}{2} x + \frac{1}{2}} \sin \lrp{\frac{\pi}{6} + \frac{2}{3} \pi y}.
\end{align*}

\setlength{\figureheight}{0.40\columnwidth}
\begin{figure}[htbp]
\begin{center}
\subfigure[Undeformed.]
{\includegraphics[trim=4cm 1cm 4cm 1cm,clip,height=\figureheight]{part2/chapter5/figures/bw/spiral}}
\subfigure[Deformed.]
{\includegraphics[trim=4cm 1cm 4cm 1cm,clip,height=\figureheight]{part2/chapter5/figures/bw/spiral_deformed}}
\caption{Spiral domain.}
\end{center}
\end{figure}

\end{enumerate}

\subsection{Convergence} \label{subsec:ch5.examples.convergence}

We embed all our testing domains in a regular square Cartesian grid over $[0,1] 
\times [0,1]$ with resolutions ranging from $32 \times 32$ to $1024 \times 1024$. We use a log-log plot of the error ($\log_2 \norm{\vec{u}^{\text{exact}} - \vec{u}^{\text{approx}}}_{\infty}$) versus the resolution ($\log_2 \text{resolution}$) to estimate the order of convergence via a least squares linear regression. We remove any solution null space in an example with entirely Neumann boundary conditions by enforcing a non-embedded Dirichlet condition on all degrees of freedom within the domain $[7/16,9/16] \times [7/16,9/16]$. We observe second order convergence over all three example domains for both Neumann and Dirichlet boundary conditions and for a wide range of material parameters, including in the nearly incompressible regime (see Figures~\ref{fig:ch5.examples.convergence.ginkgo}, \ref{fig:ch5.examples.convergence.flower}, and \ref{fig:ch5.examples.convergence.spiral}).

\setlength{\figurewidth}{0.45\columnwidth}
\begin{figure}[htbp]
\begin{center}
\subfigure[Neumann BCs; $\nu = 0.3$]
{\includegraphics[width=\figurewidth]{part2/chapter5/figures/bw/ginkgo_squeeze_pr3_neu.png}}
\subfigure[Neumann BCs; $\nu = 0.49$]
{\includegraphics[width=\figurewidth]{part2/chapter5/figures/bw/ginkgo_squeeze_pr49_neu.png}} \\
\subfigure[Dirichlet BCs; $\nu = 0.3$]
{\includegraphics[width=\figurewidth]{part2/chapter5/figures/bw/ginkgo_squeeze_pr3_noth.png}}
\subfigure[Dirichlet BCs; $\nu = 0.49$]
{\includegraphics[width=\figurewidth]{part2/chapter5/figures/bw/ginkgo_squeeze_pr49_noth_hiprol.png}}
\caption{Log-log plots of the $L^{\infty}$-error of the approximate solution versus the grid resolution, and the corresponding computed orders of convergence, $\rho$, for the keyhole domain. We stipulate an embedded Neumann boundary condition for the top ((a), (b)) examples and an embedded Dirichlet boundary condition for the bottom ((c), (d)) examples. The left ((a), (c)) examples have a Poisson's ratio of $\nu = 0.3$, while the right ((b), (d)) use a Poisson's ratio of $\nu = 0.49$, very close to the incompressible limit. Square (circle) markers in the above error plots correspond to errors in the $x$ ($y$) component.}
\label{fig:ch5.examples.convergence.ginkgo}
\end{center}
\end{figure}

\setlength{\figurewidth}{0.45\columnwidth}
\begin{figure}[htbp]
\begin{center}
\subfigure[Neumann BCs; $\nu = 0.3$]
{\includegraphics[width=\figurewidth]{part2/chapter5/figures/bw/egg_flower_pr3_neu.png}}
\subfigure[Neumann BCs; $\nu = 0.49$]
{\includegraphics[width=\figurewidth]{part2/chapter5/figures/bw/egg_flower_pr49_neu.png}}
\subfigure[Dirichlet BCs; $\nu = 0.3$]
{\includegraphics[width=\figurewidth]{part2/chapter5/figures/bw/egg_flower_pr3_noth.png}}
\subfigure[Dirichlet BCs; $\nu = 0.49$]
{\includegraphics[width=\figurewidth]{part2/chapter5/figures/bw/egg_flower_pr49_noth_hiprol.png}}
\caption{Log-log plots of the $L^{\infty}$-error of the approximate solution versus the grid resolution, and the corresponding computed orders of convergence, $\rho$, for the flower domain. We stipulate an embedded Neumann boundary condition for the top ((a), (b)) examples and an embedded Dirichlet boundary condition for the bottom ((c), (d)) examples. The left ((a), (c)) examples have a Poisson's ratio of $\nu = 0.3$, while the right ((b), (d)) use a Poisson's ratio of $\nu = 0.49$, very close to the incompressible limit. Square (circle) markers in the above error plots correspond to errors in the $x$ ($y$) component.}
\label{fig:ch5.examples.convergence.flower}
\end{center}
\end{figure}

\setlength{\figurewidth}{0.45\columnwidth}
\begin{figure}[htbp]
\begin{center}
\subfigure[Neumann BCs; $\nu = 0.3$]
{\includegraphics[width=\figurewidth]{part2/chapter5/figures/bw/fan_spiral_pr3_neu.png}}
\subfigure[Neumann BCs; $\nu = 0.49$]
{\includegraphics[width=\figurewidth]{part2/chapter5/figures/bw/fan_spiral_pr49_neu.png}}
\subfigure[Dirichlet BCs; $\nu = 0.3$]
{\includegraphics[width=\figurewidth]{part2/chapter5/figures/bw/fan_spiral_pr3_noth.png}}
\subfigure[Dirichlet BCs; $\nu = 0.49$]
{\includegraphics[width=\figurewidth]{part2/chapter5/figures/bw/fan_spiral_pr49_noth_hiprol.png}}
\caption{Log-log plots of the $L^{\infty}$-error of the approximate solution versus the grid resolution, and the corresponding computed orders of convergence, $\rho$, for the spiral domain. We stipulate an embedded Neumann boundary condition for the top ((a), (b)) examples and an embedded Dirichlet boundary condition for the bottom ((c), (d)) examples. The left ((a), (c)) examples have a Poisson's ratio of $\nu = 0.3$, while the right ((b), (d)) use a Poisson's ratio of $\nu = 0.49$, very close to the incompressible limit. Square (circle) markers in the above error plots correspond to errors in the $x$ ($y$) component.}
\label{fig:ch5.examples.convergence.spiral}
\end{center}
\end{figure}

\subsection{Multigrid} \label{subsec:ch5.examples.multigrid}

We now numerically investigate the efficiency of our multigrid framework from \S\ref{sec:ch5.multigrid}. First, we consider a periodic boundary condition problem defined on $[0,1] \times [0,1]$ with exact solution
\begin{align*}
\phi_1(x,y) & = \sin 2\pi x + \cos 2 \pi y, \\
\phi_2(x,y) & = \cos 2\pi x + \sin 2 \pi y.
\end{align*}
Although periodic boundary conditions will not appear in practical elasticity problems, we initially consider periodic boundary conditions to evaluate various algorithm parameters while avoiding complications due to boundary relaxation.

We first consider a fixed resolution of $128 \times 128$ and compare finite element distributive relaxation (described \S\ref{subsubsec:ch5.multigrid.relaxation.distributive}) and the distributive relaxation derived from the finite difference defect correction (FDDC) (described in \S\ref{subsubsec:ch5.multigrid.relaxation.defectcorrection}) as the interior relaxations. We also compare the prolongation operators $P_{\text{lo}}$ (transpose of restriction) and $P_{\text{hi}}$ (bilinear interpolation) (both described in \S\ref{subsec:ch5.multigrid.coarsening}).

While relatively compressible problems exhibit stablized convergence rates no larger than $0.3$ for a multigrid V-$(1,1)$ cycle with all discussed combinations of prolongation and distributive relaxation, we focus on the harder nearly incompressible case with Poisson's ratio $\nu = 0.49$ and investigate both V-$(1,1)$ cycle and W-$(1,1)$ cycle convergence. As shown in Table~\ref{tab:ch5.multigrid.convergence}, both finite element distributive relaxation and FDDC distributive relaxation give convergence rates less than $0.5$ with a multigrid V-$(1,1)$ cycle. Although the FDDC distributive relaxation generally gives a slower convergence than the finite element distributive relaxation for the V-$(1,1)$ cycle, combining it with bilinear interpolation prolongation or using a W-$(1,1)$ cycle brings the convergence rate down to $0.23$.

\begin{table}[htbp]
\begin{center}
\begin{tabular}{*{5}{r}}
\hline
BC & relaxation & MG cycle & $P_{\text{hi}}$ & $P_{\text{lo}}$ \\
\hline\hline
periodic & FD  & V-$(1,1)$ & 0.24 & 0.42 \\
         & FD  & W-$(1,1)$ & 0.23 & 0.25 \\
         & FEM & V-$(1,1)$ & 0.13 & 0.24 \\
         & FEM & W-$(1,1)$ & 0.13 & 0.30 \\
\hline
Dirichlet & FD  & V-$(1,1)$ & 0.72 & 0.72 \\
          & FD  & W-$(1,1)$ & 0.72 & 0.72 \\
          & FEM & V-$(1,1)$ & 0.37 & 0.36 \\
          & FEM & W-$(1,1)$ & 0.42 & 0.42 \\
\hline
Neumann & FD  & V-$(1,1)$ & 0.70 & 0.70 \\
        & FD  & W-$(1,1)$ & 0.68 & 0.68 \\
        & FEM & V-$(1,1)$ & 0.50 & 0.50 \\
        & FEM & W-$(1,1)$ & 0.35 & 0.35 \\
\hline
\end{tabular}
\caption{Asymptotic multigrid cycle convergence rates for different combinations of boundary conditions, distributive relaxation (``FEM'' refers to the finite element distributive relaxation described in \S\ref{subsubsec:ch5.multigrid.relaxation.distributive}; ``FD'' refers to the distributive relaxation based on the finite difference defect correction described in \S\ref{subsubsec:ch5.multigrid.relaxation.defectcorrection}), and prolongation ($P_{\text{lo}}$ and $P_{\text{hi}}$; see \S\ref{subsec:ch5.multigrid.coarsening}). For these results, we used the flower domain at resolution $128 \times 128$ with Poisson's ratioa $\nu = 0.49$.}
\label{tab:ch5.multigrid.convergence}
\end{center}
\end{table}

We now investigate the multigrid cycle convergence rates at various resolutions by fixing the multigrid cycle to a V-$(1,1)$ cycle with finite element distributive relaxation and low order prolongation $P_{\text{lo}}$. We observe a consistent convergence rate across a spectrum of resolutions from $32 \times 32$ to $1024 \times 1024$; see Figure~\ref{fig:ch5.multigrid.convergence.resolution}.

\setlength{\figurewidth}{0.45\columnwidth}
\begin{figure}[htbp]
\begin{center}
\includegraphics[width=\figurewidth]{part2/chapter5/figures/bw/Periodic_Square_Regular__FED_Vcycle_PLo_bw42_pr0_49_br10_residual.png}
\caption{Multigrid V-$(1,1)$ cycle convergence for a variety of resolutions between $32 \times 32$ and $1024 \times 1024$ ($\nu = 0.49$, periodic boundary conditions, finite element distributive relaxation, and low order prolongation $P_{\text{lo}}$).}
\label{fig:ch5.multigrid.convergence.resolution}
\end{center}
\end{figure}

While all combinations of parameters discussed thus far give nice convergence rates for periodic boundary conditions, convergence rates in the presence of embedded Neumann and Dirichlet boundary conditions varies; the main bottleneck is the efficacy of the boundary relaxation. Therefore, a W-$(1,1)$ cycle provides little if any advantage over a V-$(1,1)$ cycle; similarly, our two prolongation operators under consideration, $P_{\text{lo}}$ and $P_{\text{hi}}$, yield very similar convergence rates, everything else equal. The choice of interior relaxation seems to be the most differentiating characteristic when embedded boundary conditions are present; see Table~\ref{tab:ch5.multigrid.convergence}.

This time with embedded boundary conditions, we again investigate the multigrid cycle convergence rate over a variety of resolutions. Since, in the presence of embedded boundary conditions, the multigrid cycles and prolongation operators discussed previously yield largely similar convergence rates, we only give results for a V-$(1,1)$ cycle with prolongation operator $P_{\text{lo}}$. Further, motivated by the results in Table~\ref{tab:ch5.multigrid.convergence}, we use finite element distributive relaxation in the interior. As shown in Figures~\ref{fig:ch5.multigrid.convergence.flower.a} and \ref{fig:ch5.multigrid.convergence.flower.b}, we observe a consistent convergence rate over a spectrum of resolutions from $32 \times 32$ to $1024 \times 1024$.

\setlength{\figurewidth}{0.45\columnwidth}
\begin{figure}[htbp]
\begin{center}
\subfigure[Dirichlet BCs]
{\includegraphics[width=\figurewidth]{part2/chapter5/figures/bw/Egg_Flower_Dirichlet_NothG_FED_Vcycle_PLo_bw42_pr0_49_br10.png}}
\subfigure[Neumann BCs]
{\includegraphics[width=\figurewidth]{part2/chapter5/figures/bw/Egg_Flower_Neumann_FED_Vcycle_PLo_bw42_pr0_49_br10.png}}
\caption{Multigrid V-$(1,1)$ cycle convergence rates at various resolutions from $32 \times 32$ to $1024 \times 1024$ ($\nu = 0.49$).}
\label{fig:ch5.multigrid.convergence.flower.a}
\end{center}
\end{figure}

\setlength{\figurewidth}{0.45\columnwidth}
\begin{figure}[htbp]
\begin{center}
\subfigure[Dirichlet BCs]
{\includegraphics[width=\figurewidth]{part2/chapter5/figures/bw/Egg_Flower_A38_Dirichlet_NothG_FED_Vcycle_PLo_bw32_pr0_49_br10_residual.png}}
\subfigure[Neumann BCs]
{\includegraphics[width=\figurewidth]{part2/chapter5/figures/bw/Egg_Flower_A38_Neumann_FED_Vcycle_PLo_bw32_pr0_49_br10_residual.png}}
\caption{Residual norm reduction as a function of iteration number for a multigrid V-$(1,1)$ cycle at various resolutions from $32 \times 32$ to $1024 \times 1024$ ($\nu = 0.49$).}
\label{fig:ch5.multigrid.convergence.flower.b}
\end{center}
\end{figure}

\section{Discussion, Conclusion, and Future Work}

We developed a second order mixed finite element discretization for the equilibrium equations of linear elasticity practical over all material parameters from compressible to nearly incompressible. We additionally formulated a geometric multigrid framework to solve the linear system derived from the discretization. Utilizing an approximated distributive relaxation, we achieve a fast and parameter-independent multigrid cycle convergence rate in the absence of embedded boundary conditions. With the addition of embedded boundary conditions, we can still maintain good multigrid cycle convergence rates with only a small number of boundary relaxations. However, we were unable to reproduce the optimum convergence rates observed with periodic boundary conditions. Thus, future research may investigate a more efficient boundary smoother that avoids unaugmentation. We may also be interested in extending our methods to the Stokes equation.
