%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% chapters/chapter4/chapter4.tex
%
% Copyright 2012, Jeffrey Hellrung.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Poisson with Interfacial Jump Conditions} \label{chap:Poisson}

% Elliptic interface problems such as
% \begin{align}
% -\nabla \cdot \left( \beta(\mathbf{x} \right) \nabla u(\mathbf{x})) = & f(\mathbf{x}), \quad \mathbf{x} \in \Omega \setminus \Gamma; \label{eq:2.Poisson} \\
% \jump{u} = & a(\mathbf{x}), \quad \mathbf{x} \in \Gamma; \label{eq:2.Dirichlet_Jump_Condition} \\
% \jump{\beta \nabla u \cdot \hat{\mathbf{n}}} = & b(\mathbf{x}), \quad \mathbf{x} \in \Gamma; \label{eq:2.Neumann_Jump_Condition} \\
% u = & p(\mathbf{x}), \quad \mathbf{x} \in \partial\Omega_d; \label{eq:2.Dirichlet_Boundary_Condition} \\
% \beta \nabla u \cdot \hat{\mathbf{n}} = & q(\mathbf{x}), \quad \mathbf{x} \in \partial\Omega_n; \label{eq:2.Neumann_Boundary_Condition}
% \end{align}
%have a wide variety of applications in physics and engineering, and naturally arise when two dissimilar materials interact across a thin interface. Common examples include immiscible, incompressible fluids in contact and phase change problems. The interface $\Gamma$ is generally a co-dimension one closed curve (dimension $2$) or surface (dimension $3$) that divides the domain into an interior region $\Omega^-$ and an exterior region $\Omega^+$ such that $\Omega = \Omega^- \sqcup \Omega^+ \sqcup \Gamma \subset \mathbb{R}^d$ ($d = 2 \text{ or } 3$, typically). The scalar coefficient field $\beta$ and the source term $f$ can exhibit discontinuities across $\Gamma$, but have smooth restrictions $\beta^{\sigma}, f^{\sigma}$ to $\Omega^{\sigma}$, $\sigma \in \set{-,+}$. We let $\hat{\mathbf{n}}(\mathbf{x})$ denote the outward unit normal, whether to $\Omega^-$ at a point $\mathbf{x} \in \Gamma$ or to $\Omega$ at a point $\mathbf{x} \in \partial\Omega$; and define $\jump{v}(\mathbf{x}) := v^+(\mathbf{x}) - v^-(\mathbf{x}) := \lim_{\epsilon \to 0^+} v \left( \mathbf{x} + \epsilon \hat{\mathbf{n}}(\mathbf{x}) \right) - \lim_{\epsilon \to 0^+} v \left( \mathbf{x} - \epsilon \hat{\mathbf{n}}(\mathbf{x}) \right)$ as the \emph{jump} of the quantity $v$ across the interface $\Gamma$. The relevant physics generally determine the jumps in the solution \eqref{eq:Dirichlet_Jump_Condition} and in the flux \eqref{eq:Neumann_Jump_Condition}, as well as the boundary conditions on $\partial\Omega$. Unless stated otherwise, we assume the surfaces $\Gamma,\partial\Omega$ are smooth.

%Due to irregular geometry of the boundary and/or interface in many physical phenomena, a natural approach to the numerical approximation is the \emph{finite element method} (FEM) with unstructured meshes that conform to the geometry of $\Gamma$ and $\partial\Omega$ \cite{Babuska70,Bramble96,Chen.Zhiming96,Dryja05,Cockburn09,Wohlmuth99,Huang02,Lamichhane04}. However, meshing complex interface geometries can prove difficult and time-consuming when the interface frequently changes shape, especially in $3$ dimensions. Also, many numerical methods, such as geometric multigrid methods, do not naturally apply to unstructured meshes. These concerns are largely circumvented with the use of \emph{embedded} (or \emph{immersed}) methods that approximate solutions to (\ref{eq:2.Poisson}, \ref{eq:2.Dirichlet_Jump_Condition}, \ref{eq:2.Neumann_Jump_Condition}) on Cartesian grids or structured meshes that do not conform to the interface. Despite advances in this direction, embedded methods that retain higher order accuracy in $L^{\infty}$ often are limited to $2$ dimensions and introduce relatively difficult linear algebra problems and complex implementations that sometimes require significant effort to adapt to general applications.

%Recently, however, Bedrossian et al. \cite{Bedrossian10} introduced a second order virtual node method for solving the elliptic interface problem (\ref{eq:2.Poisson}, \ref{eq:2.Dirichlet_Jump_Condition}, \ref{eq:2.Neumann_Jump_Condition}, \ref{eq:2.Dirichlet_Boundary_Condition}, \ref{eq:2.Neumann_Boundary_Condition}) in $2$ dimensions. The discretization presented in \cite{Bedrossian10} is easy to implement and yields a symmetric positive definite sparse linear system for both interface problems and boundary value problems on irregular domains. In summary, this virtual node method employs a uniform Cartesian grid with duplicated Cartesian bilinear elements along the interface. These duplicated elements introduce additional \emph{virtual} nodes or degrees of freedom to accurately capture the lack of regularity in the solution. The method is variational to define stencils symmetrically, and a different discretization is used depending on proximity to embedded features, allowing for the retention of the standard $5$-point finite difference stencil away from embedded boundaries and interfaces. Langrange multipliers are used to enforce embedded Dirichlet conditions \eqref{eq:Dirichlet_Boundary_Condition} and embedded jump conditions \eqref{eq:Dirichlet_Jump_Condition}, and the choice of Lagrange multiplier space admits a symmetric positive definite discretization. In the special case when $\beta$ is smooth, a discontinuity removal technique allows the use of the standard $5$-point Poisson stencil even across the embedded interface.

%The feature set of this virtual node approach is very powerful. In the present work, we improve many aspects of \cite{Bedrossian10} and provide key modifications necessary to extend the method to $3$ dimensions. Within the context of embedded Dirichlet and embedded interface discretizations, we present a novel and flexible algorithm to define the discrete Lagrange multiplier space. This algorithm gives more control on the conditioning of the resulting linear system and specifically addresses the conditioning issues (see Appendix \ref{sec:Appendix_Double_Wide_Constraint_Conditioning}) we found in the straightforward extension of \cite{Bedrossian10} to $3$ dimensions. We also give an expanded treatment of the discontinuity removal technique, detailing an algorithm for the construction of a scalar function satisfying the jump conditions (\ref{eq:2.Dirichlet_Jump_Condition}, \ref{eq:2.Neumann_Jump_Condition}). Specific to the $3$-dimensional implementation, we describe an algorithm for creating a polyhedral representation of cell-local interface/boundary geometry and quadrature rules suitable for these polyhedral surfaces. Finally, we present a family of multigrid algorithms that solve (\ref{eq:2.Poisson}, \ref{eq:2.Dirichlet_Jump_Condition}, \ref{eq:2.Neumann_Jump_Condition}, \ref{eq:2.Dirichlet_Boundary_Condition}, \ref{eq:2.Neumann_Boundary_Condition}) with near-optimal multigrid efficiency.

%The remainder of the paper proceeds as follows. We review existing embedded methods and related multigrid algorithms in \S\ref{sec:Existing_Methods}. \S\ref{sec:Discretization} presents our numerical discretizations for embedded Neumann (\S\ref{subsec:Discretization_Neumann}), embedded Dirichlet (\S\ref{subsec:Discretization_Dirichlet}), and embedded interface problems (\S\ref{subsec:Discretization_Interface}). We outline our new constraint aggregation algorithm as it applies to our embedded Dirichlet discretization in \S\ref{subsubsec:Constraint_Aggregation}, and detail the special case in embedded interface problems of smooth $\beta$ in \S\ref{subsubsec:Discretization_Interface_Discontinuity_Removal}. \S\ref{sec:Multigrid} explains the components of our multigrid algorithms for all discretization types. We use numerical examples to demonstrate the accuracy of our discretization and the performance of our multigrid solvers in \S\ref{sec:Numerical_Examples}, and we conclude with a short summary and discussion in \S\ref{sec:Discussion_And_Conclusion}. We include an appendix with some additional miscellaneous details.
